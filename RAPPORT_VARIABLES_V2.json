{
    "scan_date": "2025-12-15 11:19:51",
    "total_files": 371,
    "files_with_problems": 101,
    "total_problems": 709,
    "problems_by_file": {
        "admin\\catalogue\\categories.php": {
            "problems": [
                {
                    "var": "actif",
                    "line": 35,
                    "context": "$stmt->execute([$nom, $slug, $actif, $ordre]);"
                },
                {
                    "var": "actif",
                    "line": 63,
                    "context": "$stmt->execute([$nom, $slug, $actif, $ordre, $id]);"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "action",
                "nom",
                "ordre",
                "slug",
                "stmt",
                "id",
                "count",
                "categories",
                "text",
                "cat"
            ],
            "used": 39
        },
        "admin\\catalogue\\import.php": {
            "problems": [
                {
                    "var": "header",
                    "line": 352,
                    "context": "<?php foreach (array_keys($preview[0]) as $header): ?>"
                },
                {
                    "var": "header",
                    "line": 353,
                    "context": "<th><?= htmlspecialchars($header) ?></th>"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "step",
                "2": "errors",
                "3": "success",
                "4": "preview",
                "5": "categories",
                "6": "stmt",
                "7": "action",
                "8": "file",
                "9": "ext",
                "10": "tmpfile",
                "11": "rows",
                "12": "result",
                "13": "filepath",
                "14": "data",
                "15": "handle",
                "16": "headers",
                "17": "row_num",
                "18": "row",
                "19": "item",
                "21": "zip",
                "22": "xml_content",
                "23": "xml",
                "25": "cells",
                "26": "cell",
                "27": "value",
                "30": "count",
                "31": "idx",
                "33": "code",
                "34": "designation",
                "35": "categorie_id",
                "36": "prix_unite",
                "37": "slug",
                "38": "e",
                "39": "err"
            },
            "used": 114
        },
        "admin\\catalogue\\produit_delete.php": {
            "problems": [
                {
                    "var": "id",
                    "line": 15,
                    "context": "if ($id <= 0) {"
                },
                {
                    "var": "id",
                    "line": 25,
                    "context": "$stmt->execute([$id]);"
                },
                {
                    "var": "id",
                    "line": 57,
                    "context": "$stmt->execute([$id]);"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "stmt",
                "produit",
                "filepath",
                "galerie",
                "img",
                "e"
            ],
            "used": 18
        },
        "admin\\catalogue\\produit_edit.php": {
            "problems": [
                {
                    "var": "prix_unite",
                    "line": 150,
                    "context": "$prix_unite, $prix_gros, $description,"
                },
                {
                    "var": "prix_gros",
                    "line": 150,
                    "context": "$prix_unite, $prix_gros, $description,"
                },
                {
                    "var": "galerie_json",
                    "line": 151,
                    "context": "$caracteristiques_json, $image_principale, $galerie_json,"
                },
                {
                    "var": "actif",
                    "line": 152,
                    "context": "$actif, $id"
                },
                {
                    "var": "prix_unite",
                    "line": 165,
                    "context": "$prix_unite, $prix_gros, $description,"
                },
                {
                    "var": "prix_gros",
                    "line": 165,
                    "context": "$prix_unite, $prix_gros, $description,"
                },
                {
                    "var": "galerie_json",
                    "line": 166,
                    "context": "$caracteristiques_json, $image_principale, $galerie_json,"
                },
                {
                    "var": "actif",
                    "line": 167,
                    "context": "$actif"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "is_edit",
                "2": "produit",
                "3": "stmt",
                "4": "categories",
                "5": "code",
                "6": "designation",
                "7": "categorie_id",
                "8": "description",
                "9": "errors",
                "10": "slug",
                "11": "image_principale",
                "12": "upload_result",
                "13": "galerie_images",
                "14": "key",
                "15": "tmp_name",
                "16": "file",
                "17": "caracteristiques_json",
                "18": "carac",
                "19": "item",
                "20": "sql",
                "21": "id",
                "22": "e",
                "23": "text",
                "25": "folder",
                "26": "upload_dir",
                "27": "allowed_types",
                "28": "max_size",
                "29": "extension",
                "30": "filename",
                "31": "filepath",
                "32": "caracteristiques",
                "33": "carac_obj",
                "34": "k",
                "35": "v",
                "36": "cat",
                "37": "idx",
                "39": "img"
            },
            "used": 128
        },
        "admin\\fix_complete.php": {
            "problems": [
                {
                    "var": "montant",
                    "line": 101,
                    "context": "[$sens, $montant, $comment] = $row;"
                },
                {
                    "var": "comment",
                    "line": 101,
                    "context": "[$sens, $montant, $comment] = $row;"
                },
                {
                    "var": "comment",
                    "line": 104,
                    "context": "$stmt->execute([$todayDate, $numeroPiece, $comment, $sens, $montant, $comment, $typeOperation]);"
                },
                {
                    "var": "montant",
                    "line": 104,
                    "context": "$stmt->execute([$todayDate, $numeroPiece, $comment, $sens, $montant, $comment, $typeOperation]);"
                },
                {
                    "var": "comment",
                    "line": 104,
                    "context": "$stmt->execute([$todayDate, $numeroPiece, $comment, $sens, $montant, $comment, $typeOperation]);"
                },
                {
                    "var": "montant",
                    "line": 105,
                    "context": "$total += $montant;"
                },
                {
                    "var": "comment",
                    "line": 106,
                    "context": "echo \"   \u2713 $comment: $montant F\\n\";"
                },
                {
                    "var": "montant",
                    "line": 106,
                    "context": "echo \"   \u2713 $comment: $montant F\\n\";"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "stmt",
                "2": "cols",
                "3": "col",
                "4": "columns_to_add",
                "5": "sql",
                "6": "e",
                "7": "count",
                "8": "new_count",
                "10": "todayDate",
                "11": "numero",
                "12": "data",
                "13": "total",
                "14": "i",
                "15": "row",
                "16": "numeroPiece",
                "17": "typeOperation",
                "18": "sens",
                "20": "result"
            },
            "used": 40
        },
        "admin\\migrate_phase_1_2.php": {
            "problems": [
                {
                    "var": "s",
                    "line": 158,
                    "context": "'overall_status' => (count(array_filter($migration_steps, fn($s) => $s['status'] === 'failed')) === 0) ? 'SUCCESS' : 'PARTIAL',"
                },
                {
                    "var": "s",
                    "line": 158,
                    "context": "'overall_status' => (count(array_filter($migration_steps, fn($s) => $s['status'] === 'failed')) === 0) ? 'SUCCESS' : 'PARTIAL',"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "migration_steps",
                "sql_ensure",
                "columns_to_add",
                "sql",
                "e",
                "stmt",
                "sql_migrate"
            ],
            "used": 39
        },
        "analyser_bilan.php": {
            "problems": [
                {
                    "var": "produits",
                    "line": 268,
                    "context": "$resultat = $produits - $charges;"
                },
                {
                    "var": "charges",
                    "line": 268,
                    "context": "$resultat = $produits - $charges;"
                }
            ],
            "requires": [],
            "defined": {
                "0": "stmt",
                "1": "exercice",
                "2": "sql",
                "3": "comptes",
                "4": "total_debit_global",
                "5": "total_credit_global",
                "6": "totaux_par_classe",
                "7": "compte",
                "8": "classe",
                "9": "solde",
                "10": "position",
                "11": "position_color",
                "12": "class_row",
                "13": "premier_chiffre",
                "14": "actif_total",
                "15": "passif_total",
                "16": "montant",
                "21": "resultat",
                "22": "ecart",
                "23": "problemes",
                "25": "pb",
                "26": "e"
            },
            "used": 112
        },
        "audit_complet.php": {
            "problems": [
                {
                    "var": "matches",
                    "line": 93,
                    "context": "if (preg_match('/\\$_POST\\[[\\'\"](\\w+)[\\'\"]\\](?!\\s*\\?\\?|(?!\\s*isset))/', $content, $matches)) {"
                },
                {
                    "var": "matches",
                    "line": 125,
                    "context": "if (preg_match_all('/(?:require|include)(?:_once)?\\s*[\\'\"]([^\\'\"]+)[\\'\"]/', $content, $matches)) {"
                },
                {
                    "var": "matches",
                    "line": 166,
                    "context": "if (preg_match_all('/FROM\\s+([a-zA-Z_]\\w*)/i', $content, $matches)) {"
                },
                {
                    "var": "matches",
                    "line": 175,
                    "context": "if (preg_match_all('/([a-z_]\\w*)\\.([a-z_]\\w*)\\b/i', $content, $matches)) {"
                },
                {
                    "var": "matches",
                    "line": 176,
                    "context": "for ($i = 0; $i < count($matches[0]); $i++) {"
                },
                {
                    "var": "matches",
                    "line": 177,
                    "context": "$pair = $matches[1][$i] . '.' . $matches[2][$i];"
                },
                {
                    "var": "matches",
                    "line": 177,
                    "context": "$pair = $matches[1][$i] . '.' . $matches[2][$i];"
                },
                {
                    "var": "col",
                    "line": 192,
                    "context": "foreach (array_slice($dbColumns, 0, 10) as $col) {"
                },
                {
                    "var": "col",
                    "line": 193,
                    "context": "echo \"  \u2713 $col\\n\";"
                },
                {
                    "var": "page",
                    "line": 219,
                    "context": "foreach (array_slice($pages, 0, 15) as $page) {"
                },
                {
                    "var": "page",
                    "line": 220,
                    "context": "echo \"  \u2713 /$page\\n\";"
                }
            ],
            "requires": [
                " => $incPath\r\n                ];\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nif (count($missingIncludes) > 0) {\r\n    echo ",
                "] . "
            ],
            "defined": {
                "0": "dir",
                "1": "files",
                "2": "iterator",
                "3": "path",
                "4": "rel",
                "5": "phpFiles",
                "6": "syntaxErrors",
                "7": "checkedCount",
                "8": "file",
                "9": "output",
                "10": "err",
                "11": "securityIssues",
                "13": "content",
                "14": "issue",
                "15": "missingIncludes",
                "17": "incPath",
                "18": "absPath",
                "19": "miss",
                "20": "dbTables",
                "21": "dbColumns",
                "23": "table",
                "24": "i",
                "25": "pair",
                "26": "pages",
                "28": "totalIssues",
                "29": "report"
            },
            "used": 108
        },
        "audit_technique.php": {
            "problems": [
                {
                    "var": "output",
                    "line": 79,
                    "context": "exec(\"php -l \\\"$filePath\\\" 2>&1\", $output, $code);"
                },
                {
                    "var": "code",
                    "line": 79,
                    "context": "exec(\"php -l \\\"$filePath\\\" 2>&1\", $output, $code);"
                },
                {
                    "var": "code",
                    "line": 80,
                    "context": "if ($code !== 0) {"
                },
                {
                    "var": "output",
                    "line": 84,
                    "context": "'msg' => implode(\"\\n\", $output),"
                },
                {
                    "var": "matches",
                    "line": 91,
                    "context": "if (preg_match_all('/(?:require|include)(?:_once)?\\s*[\\'\"]([^\\'\"]+)[\\'\"]/', $content, $matches)) {"
                },
                {
                    "var": "matches",
                    "line": 92,
                    "context": "$result['requires'] = $matches[1];"
                },
                {
                    "var": "matches",
                    "line": 96,
                    "context": "if (preg_match_all('/(\\w+)\\s*\\(/', $content, $matches)) {"
                },
                {
                    "var": "matches",
                    "line": 97,
                    "context": "$result['calls_functions'] = array_unique($matches[1]);"
                },
                {
                    "var": "matches",
                    "line": 102,
                    "context": "if (preg_match_all('/\\$([a-zA-Z_]\\w*)/', $content, $matches)) {"
                },
                {
                    "var": "matches",
                    "line": 103,
                    "context": "$vars = array_unique($matches[1]);"
                },
                {
                    "var": "matches",
                    "line": 120,
                    "context": "if (preg_match_all('/FROM\\s+([a-zA-Z_]\\w*)/i', $content, $matches)) {"
                },
                {
                    "var": "matches",
                    "line": 121,
                    "context": "$result['db_tables'] = array_unique($matches[1]);"
                },
                {
                    "var": "matches",
                    "line": 123,
                    "context": "if (preg_match_all('/\\b([a-zA-Z_]\\w*)\\.([a-zA-Z_]\\w*)\\b/', $content, $matches)) {"
                },
                {
                    "var": "matches",
                    "line": 124,
                    "context": "for ($i = 0; $i < count($matches[0]); $i++) {"
                },
                {
                    "var": "matches",
                    "line": 125,
                    "context": "$result['db_columns'][] = $matches[1][$i] . '.' . $matches[2][$i];"
                },
                {
                    "var": "matches",
                    "line": 125,
                    "context": "$result['db_columns'][] = $matches[1][$i] . '.' . $matches[2][$i];"
                }
            ],
            "requires": [
                ", ",
                ", ",
                ", ",
                ",\r\n        "
            ],
            "defined": {
                "0": "pdo",
                "1": "errors",
                "2": "warnings",
                "3": "infos",
                "4": "dir",
                "5": "excludeDirs",
                "6": "files",
                "7": "iterator",
                "8": "path",
                "9": "relative",
                "10": "skip",
                "11": "exclude",
                "12": "filePath",
                "14": "fileName",
                "15": "content",
                "16": "result",
                "17": "vars",
                "18": "var",
                "19": "assigned",
                "20": "isGlobal",
                "21": "i",
                "22": "func",
                "23": "builtins",
                "24": "custom",
                "25": "phpFiles",
                "26": "results",
                "27": "fileCount",
                "28": "errorCount",
                "29": "warningCount",
                "30": "file",
                "31": "criticalCount",
                "32": "highCount",
                "33": "mediumCount",
                "34": "lowCount",
                "36": "issue"
            },
            "used": 116
        },
        "caisse\\journal.php": {
            "problems": [
                {
                    "var": "venteId",
                    "line": 103,
                    "context": "'vente_id'                 => $venteId ?: null,"
                },
                {
                    "var": "reservationId",
                    "line": 104,
                    "context": "'reservation_id'           => $reservationId ?: null,"
                },
                {
                    "var": "inscriptionId",
                    "line": 105,
                    "context": "'inscription_formation_id' => $inscriptionId ?: null,"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "peutEcrire",
                "2": "opId",
                "3": "utilisateur",
                "4": "annuleParId",
                "5": "stmt",
                "6": "dateOperation",
                "7": "sens",
                "8": "nature",
                "9": "numeroPiece",
                "10": "montant",
                "11": "modeId",
                "12": "observations",
                "13": "erreurs",
                "14": "respId",
                "15": "numeroPieceValue",
                "16": "e",
                "17": "today",
                "18": "dateDebut",
                "19": "dateFin",
                "20": "where",
                "21": "params",
                "22": "whereSql",
                "23": "sql",
                "24": "operations",
                "25": "output",
                "26": "op",
                "27": "statut",
                "28": "flashSuccess",
                "29": "flashError",
                "30": "modesPaiement",
                "31": "totalRecettes",
                "32": "totalDepenses",
                "34": "solde",
                "35": "mp",
                "36": "modeFiltre"
            },
            "used": 136
        },
        "caisse\\reconciliation_jour.php": {
            "problems": [
                {
                    "var": "r",
                    "line": 14,
                    "context": "foreach ($stmt->fetchAll(PDO::FETCH_ASSOC) as $r) {"
                },
                {
                    "var": "r",
                    "line": 15,
                    "context": "$totaux[$r['sens']] = (float)$r['total'];"
                },
                {
                    "var": "r",
                    "line": 15,
                    "context": "$totaux[$r['sens']] = (float)$r['total'];"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "date",
                "stmt",
                "totaux",
                "solde",
                "stmtV",
                "totalVentesTTC",
                "ecarts",
                "e"
            ],
            "used": 26
        },
        "catalogue\\api\\produits.php": {
            "problems": [
                {
                    "var": "categorieId",
                    "line": 14,
                    "context": "'categorie_id' => $categorieId,"
                },
                {
                    "var": "page",
                    "line": 15,
                    "context": "], $page, $pageSize);"
                },
                {
                    "var": "pageSize",
                    "line": 15,
                    "context": "], $page, $pageSize);"
                },
                {
                    "var": "page",
                    "line": 21,
                    "context": "'page'      => $page,"
                },
                {
                    "var": "pageSize",
                    "line": 22,
                    "context": "'page_size' => $pageSize,"
                }
            ],
            "requires": [],
            "defined": [
                "q",
                "data"
            ],
            "used": 9
        },
        "catalogue\\index.php": {
            "problems": [
                {
                    "var": "page",
                    "line": 14,
                    "context": "], $page, $pageSize);"
                },
                {
                    "var": "page",
                    "line": 92,
                    "context": "<a href=\"<?= htmlspecialchars(url_for('catalogue/index.php') . '?page=' . ($page + 1) . ($q !== '' ? ('&q=' . urlencode($q)) : '') . ($categorieId ? ('&categorie_id=' . $categorieId) : '')) ?>\">"
                }
            ],
            "requires": [],
            "defined": [
                "q",
                "pageSize",
                "categories",
                "productsData",
                "products",
                "hasMore",
                "total",
                "searchEndpoint",
                "listEndpoint",
                "detailBase",
                "assetCss",
                "assetJs",
                "categorieId",
                "cat",
                "isActive",
                "prod",
                "img",
                "detailUrl",
                "prixUnite",
                "prixGros"
            ],
            "used": 41
        },
        "check_ordres_prep.php": {
            "problems": [
                {
                    "var": "field",
                    "line": 15,
                    "context": "foreach (array_keys($row) as $field) {"
                },
                {
                    "var": "field",
                    "line": 16,
                    "context": "echo \"  - $field\\n\";"
                }
            ],
            "requires": [
                "security.php"
            ],
            "defined": {
                "0": "pdo",
                "1": "utilisateur",
                "3": "stmt",
                "4": "row"
            },
            "used": 8
        },
        "check_ruptures.php": {
            "problems": [
                {
                    "var": "matches",
                    "line": 23,
                    "context": "if (preg_match('/CREATE TABLE IF NOT EXISTS `ruptures_signalees`[^;]+;/s', $sql, $matches)) {"
                },
                {
                    "var": "matches",
                    "line": 24,
                    "context": "echo $matches[0] . \"\\n\\n\";"
                },
                {
                    "var": "matches",
                    "line": 32,
                    "context": "$pdo->exec($matches[0]);"
                }
            ],
            "requires": [],
            "defined": [
                "stmt",
                "exists",
                "col",
                "sql",
                "handle",
                "line",
                "e"
            ],
            "used": 12
        },
        "check_stocks_mouvements.php": {
            "problems": [
                {
                    "var": "field",
                    "line": 14,
                    "context": "foreach (array_keys($row) as $field) {"
                },
                {
                    "var": "field",
                    "line": 15,
                    "context": "echo \"  - $field\\n\";"
                }
            ],
            "requires": [
                "security.php"
            ],
            "defined": {
                "0": "pdo",
                "1": "utilisateur",
                "3": "stmt",
                "4": "row"
            },
            "used": 7
        },
        "check_ventes_struct.php": {
            "problems": [
                {
                    "var": "field",
                    "line": 15,
                    "context": "foreach (array_keys($row) as $field) {"
                },
                {
                    "var": "field",
                    "line": 16,
                    "context": "echo \"  - $field\\n\";"
                }
            ],
            "requires": [
                "security.php"
            ],
            "defined": {
                "0": "pdo",
                "1": "utilisateur",
                "3": "stmt",
                "4": "row"
            },
            "used": 8
        },
        "components\\search_filter_bar.php": {
            "problems": [
                {
                    "var": "val",
                    "line": 62,
                    "context": "foreach (($_GET['filters'] ?? []) as $key => $val) {"
                }
            ],
            "requires": [],
            "defined": [
                "slot",
                "activeFilters",
                "key",
                "label",
                "value"
            ],
            "used": 5
        },
        "components\\sortable_header.php": {
            "problems": [
                {
                    "var": "sortBy",
                    "line": 4,
                    "context": "* Usage: <?= renderSortableHeader('Date', 'date', $sortBy, $sortDir, $_GET) ?>"
                },
                {
                    "var": "sortDir",
                    "line": 4,
                    "context": "* Usage: <?= renderSortableHeader('Date', 'date', $sortBy, $sortDir, $_GET) ?>"
                },
                {
                    "var": "v",
                    "line": 30,
                    "context": "$params = array_filter($params, fn($v) => $v !== '' && $v !== '0' && $v !== null);"
                },
                {
                    "var": "v",
                    "line": 30,
                    "context": "$params = array_filter($params, fn($v) => $v !== '' && $v !== '0' && $v !== null);"
                },
                {
                    "var": "v",
                    "line": 30,
                    "context": "$params = array_filter($params, fn($v) => $v !== '' && $v !== '0' && $v !== null);"
                },
                {
                    "var": "v",
                    "line": 30,
                    "context": "$params = array_filter($params, fn($v) => $v !== '' && $v !== '0' && $v !== null);"
                }
            ],
            "requires": [],
            "defined": {
                "0": "label",
                "1": "fieldKey",
                "2": "currentSortBy",
                "3": "currentSortDir",
                "4": "queryParams",
                "5": "newDir",
                "6": "query",
                "7": "url",
                "8": "icon",
                "9": "filters",
                "10": "additionalParams",
                "11": "params",
                "12": "activeFilters",
                "13": "html",
                "15": "value"
            },
            "used": 24
        },
        "compta\\export_bilan.php": {
            "problems": [
                {
                    "var": "exerciceId",
                    "line": 12,
                    "context": "if ($exerciceId > 0) {"
                },
                {
                    "var": "exerciceId",
                    "line": 14,
                    "context": "$stmt->execute([$exerciceId]);"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "stmt",
                "2": "exercice",
                "3": "sql",
                "4": "comptes",
                "5": "actif",
                "6": "passif",
                "7": "compte",
                "8": "solde",
                "9": "totalActif",
                "10": "totalPassif",
                "11": "currentClasse",
                "13": "classeLib"
            },
            "used": 56
        },
        "compta\\journaux.php": {
            "problems": [
                {
                    "var": "piece_id",
                    "line": 28,
                    "context": "if ($action === 'detail' && $piece_id > 0) {"
                },
                {
                    "var": "piece_id",
                    "line": 39,
                    "context": "$stmt->execute([$piece_id]);"
                },
                {
                    "var": "piece_id",
                    "line": 47,
                    "context": "$ecritures = compta_get_ecritures_piece($pdo, $piece_id);"
                }
            ],
            "requires": [],
            "defined": [
                "action",
                "stmt",
                "journaux",
                "exercice",
                "flash_success",
                "flash_error",
                "piece",
                "ecritures",
                "total_debit",
                "total_credit",
                "e",
                "est_equilibree",
                "journal_id",
                "j",
                "count",
                "journal",
                "pieces",
                "p"
            ],
            "used": 66
        },
        "compta\\parametrage_mappings.php": {
            "problems": [
                {
                    "var": "actif",
                    "line": 71,
                    "context": "$stmt->execute([$source_type, $code_operation, $journal_id, $compte_debit_id, $compte_credit_id, $description, $actif, $id]);"
                }
            ],
            "requires": [],
            "defined": {
                "0": "action",
                "1": "flash_success",
                "2": "flash_error",
                "3": "operation_types",
                "4": "action_form",
                "5": "source_type",
                "6": "code_operation",
                "7": "journal_id",
                "8": "compte_debit_id",
                "9": "compte_credit_id",
                "10": "description",
                "11": "stmt",
                "12": "e",
                "13": "id",
                "16": "mappings",
                "17": "journaux",
                "18": "comptes",
                "19": "mapping_edit",
                "20": "edit_id",
                "21": "op_type",
                "22": "j",
                "23": "c",
                "25": "m"
            },
            "used": 81
        },
        "compta\\plan_comptable.php": {
            "problems": [
                {
                    "var": "est_actif",
                    "line": 32,
                    "context": "$stmt->execute([$numero, $libelle, $classe, $type, $nature, $est_actif, $parent_id]);"
                },
                {
                    "var": "parent_id",
                    "line": 32,
                    "context": "$stmt->execute([$numero, $libelle, $classe, $type, $nature, $est_actif, $parent_id]);"
                },
                {
                    "var": "est_actif",
                    "line": 41,
                    "context": "$stmt->execute([$numero, $libelle, $classe, $type, $nature, $est_actif, $parent_id, $compte_id]);"
                },
                {
                    "var": "parent_id",
                    "line": 41,
                    "context": "$stmt->execute([$numero, $libelle, $classe, $type, $nature, $est_actif, $parent_id, $compte_id]);"
                },
                {
                    "var": "compte_id",
                    "line": 41,
                    "context": "$stmt->execute([$numero, $libelle, $classe, $type, $nature, $est_actif, $parent_id, $compte_id]);"
                },
                {
                    "var": "compte_id",
                    "line": 49,
                    "context": "if ($action === 'delete' && $compte_id > 0) {"
                },
                {
                    "var": "compte_id",
                    "line": 50,
                    "context": "$pdo->prepare(\"DELETE FROM compta_comptes WHERE id = ?\")->execute([$compte_id]);"
                },
                {
                    "var": "compte_id",
                    "line": 62,
                    "context": "if ($action === 'edit' && $compte_id > 0) {"
                },
                {
                    "var": "compte_id",
                    "line": 64,
                    "context": "$stmt->execute([$compte_id]);"
                },
                {
                    "var": "compte_id",
                    "line": 191,
                    "context": "<?php if ($c['id'] !== $compte_id): ?>"
                }
            ],
            "requires": [],
            "defined": {
                "0": "action",
                "1": "numero",
                "2": "libelle",
                "3": "classe",
                "4": "type",
                "5": "nature",
                "6": "stmt",
                "7": "e",
                "8": "compte",
                "9": "tous_comptes",
                "10": "comptes_par_classe",
                "11": "c",
                "12": "flash_success",
                "13": "flash_error",
                "16": "classe_labels"
            },
            "used": 68
        },
        "coordination\\api\\clients_search.php": {
            "problems": [
                {
                    "var": "r",
                    "line": 15,
                    "context": "echo json_encode(array_map(function($r){"
                },
                {
                    "var": "r",
                    "line": 17,
                    "context": "'id' => (int)$r['id'],"
                },
                {
                    "var": "r",
                    "line": 19,
                    "context": "'nom' => $r['nom'],"
                },
                {
                    "var": "r",
                    "line": 20,
                    "context": "'telephone' => $r['telephone'] ?? ''"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "q",
                "stmt",
                "rows"
            ],
            "used": 9
        },
        "coordination\\api\\produits_search.php": {
            "problems": [
                {
                    "var": "r",
                    "line": 15,
                    "context": "echo json_encode(array_map(function($r){"
                },
                {
                    "var": "r",
                    "line": 17,
                    "context": "'id' => (int)$r['id'],"
                },
                {
                    "var": "r",
                    "line": 18,
                    "context": "'label' => ($r['code_produit'] ?: '') . ' \u2022 ' . $r['designation'] . ' \u2022 Stock: ' . (int)($r['stock_actuel'] ?? 0),"
                },
                {
                    "var": "r",
                    "line": 18,
                    "context": "'label' => ($r['code_produit'] ?: '') . ' \u2022 ' . $r['designation'] . ' \u2022 Stock: ' . (int)($r['stock_actuel'] ?? 0),"
                },
                {
                    "var": "r",
                    "line": 18,
                    "context": "'label' => ($r['code_produit'] ?: '') . ' \u2022 ' . $r['designation'] . ' \u2022 Stock: ' . (int)($r['stock_actuel'] ?? 0),"
                },
                {
                    "var": "r",
                    "line": 19,
                    "context": "'code' => $r['code_produit'] ?: '',"
                },
                {
                    "var": "r",
                    "line": 20,
                    "context": "'designation' => $r['designation'],"
                },
                {
                    "var": "r",
                    "line": 21,
                    "context": "'stock' => (int)($r['stock_actuel'] ?? 0)"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "q",
                "stmt",
                "rows"
            ],
            "used": 13
        },
        "coordination\\api\\ventes_search.php": {
            "problems": [
                {
                    "var": "r",
                    "line": 22,
                    "context": "echo json_encode(array_map(function($r){"
                },
                {
                    "var": "r",
                    "line": 24,
                    "context": "'id' => (int)$r['id'],"
                },
                {
                    "var": "r",
                    "line": 25,
                    "context": "'label' => $r['numero'] . ' \u2022 ' . $r['client_nom'] . ' \u2022 ' . date('d/m/Y', strtotime($r['date_vente'])) . ' \u2022 ' . number_format((float)$r['montant_total_ttc'], 0, ',', ' ') . ' FCFA',"
                },
                {
                    "var": "r",
                    "line": 25,
                    "context": "'label' => $r['numero'] . ' \u2022 ' . $r['client_nom'] . ' \u2022 ' . date('d/m/Y', strtotime($r['date_vente'])) . ' \u2022 ' . number_format((float)$r['montant_total_ttc'], 0, ',', ' ') . ' FCFA',"
                },
                {
                    "var": "r",
                    "line": 25,
                    "context": "'label' => $r['numero'] . ' \u2022 ' . $r['client_nom'] . ' \u2022 ' . date('d/m/Y', strtotime($r['date_vente'])) . ' \u2022 ' . number_format((float)$r['montant_total_ttc'], 0, ',', ' ') . ' FCFA',"
                },
                {
                    "var": "r",
                    "line": 25,
                    "context": "'label' => $r['numero'] . ' \u2022 ' . $r['client_nom'] . ' \u2022 ' . date('d/m/Y', strtotime($r['date_vente'])) . ' \u2022 ' . number_format((float)$r['montant_total_ttc'], 0, ',', ' ') . ' FCFA',"
                },
                {
                    "var": "r",
                    "line": 26,
                    "context": "'numero' => $r['numero'],"
                },
                {
                    "var": "r",
                    "line": 27,
                    "context": "'client_nom' => $r['client_nom'],"
                },
                {
                    "var": "r",
                    "line": 28,
                    "context": "'client_id' => (int)$r['client_id'],"
                },
                {
                    "var": "r",
                    "line": 29,
                    "context": "'date' => $r['date_vente'],"
                },
                {
                    "var": "r",
                    "line": 30,
                    "context": "'montant' => (float)$r['montant_total_ttc'],"
                },
                {
                    "var": "r",
                    "line": 31,
                    "context": "'statut' => $r['statut']"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "q",
                "clientId",
                "where",
                "params",
                "whereSql",
                "stmt",
                "rows"
            ],
            "used": 27
        },
        "coordination\\corriger_synchronisation.php": {
            "problems": [
                {
                    "var": "venteId",
                    "line": 15,
                    "context": "if (!$venteId) {"
                },
                {
                    "var": "venteId",
                    "line": 28,
                    "context": "$stmt->execute([$venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 49,
                    "context": "$stmt->execute([$venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 72,
                    "context": "$venteId,"
                },
                {
                    "var": "venteId",
                    "line": 82,
                    "context": "$stmt->execute([$venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 106,
                    "context": "$stmt->execute([$venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 116,
                    "context": "$stmt->execute([$venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 126,
                    "context": "$stmt->execute([$venteId, $ligne['produit_id']]);"
                },
                {
                    "var": "venteId",
                    "line": 135,
                    "context": "'source_id'      => $venteId,"
                },
                {
                    "var": "venteId",
                    "line": 152,
                    "context": "$stmt->execute([$venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 155,
                    "context": "compta_creer_ecritures_vente($pdo, $venteId);"
                },
                {
                    "var": "venteId",
                    "line": 171,
                    "context": "$stmt->execute([$venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 179,
                    "context": "$stmt->execute([$venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 194,
                    "context": "$stmt->execute([$nouveauStatut, $venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 222,
                    "context": "$stmt->execute([$venteId, $venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 222,
                    "context": "$stmt->execute([$venteId, $venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 237,
                    "context": "'source_id'      => $venteId,"
                },
                {
                    "var": "venteId",
                    "line": 251,
                    "context": "'source_id'      => $venteId,"
                },
                {
                    "var": "venteId",
                    "line": 274,
                    "context": "header('Location: ' . url_for('coordination/corriger_synchronisation.php?vente_id=' . $venteId));"
                },
                {
                    "var": "venteId",
                    "line": 287,
                    "context": "$stmt->execute([$venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 294,
                    "context": "$stmt->execute([$venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 302,
                    "context": "$stmt->execute([$venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 308,
                    "context": "$stmt->execute([$venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 558,
                    "context": "<a href=\"<?= url_for('ventes/detail.php?id=' . (int)$venteId) ?>\" class=\"btn btn-primary\">"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "stmt",
                "2": "vente",
                "3": "action",
                "4": "existant",
                "5": "stmtCount",
                "6": "count",
                "7": "numero_bl",
                "8": "utilisateur",
                "9": "blId",
                "10": "lignes",
                "11": "ligne",
                "12": "bl",
                "13": "dateLivraison",
                "15": "result",
                "16": "qteLivree",
                "17": "qteCommandee",
                "18": "nouveauStatut",
                "19": "produitsAnalyse",
                "20": "countAjustements",
                "21": "prod",
                "22": "ecart",
                "23": "ecartPositif",
                "24": "e",
                "25": "infoBL",
                "26": "infoStock",
                "27": "infoCompta",
                "28": "infoQte",
                "29": "flashSuccess",
                "30": "flashError",
                "31": "flashWarning"
            },
            "used": 128
        },
        "coordination\\litiges.php": {
            "problems": [
                {
                    "var": "dateDebut",
                    "line": 264,
                    "context": "<input type=\"date\" name=\"date_debut\" class=\"form-control form-control-sm\" value=\"<?= htmlspecialchars($dateDebut) ?>\">"
                },
                {
                    "var": "dateFin",
                    "line": 268,
                    "context": "<input type=\"date\" name=\"date_fin\" class=\"form-control form-control-sm\" value=\"<?= htmlspecialchars($dateFin) ?>\">"
                },
                {
                    "var": "dateDebut",
                    "line": 277,
                    "context": "<a href=\"<?= url_for('coordination/export_excel.php?date_debut=' . urlencode($dateDebut) . '&date_fin=' . urlencode($dateFin) . '&statut=' . urlencode($statut) . '&type=' . urlencode($type) . '&search=' . urlencode($search)) ?>\" class=\"btn btn-sm btn-success\">"
                },
                {
                    "var": "dateFin",
                    "line": 277,
                    "context": "<a href=\"<?= url_for('coordination/export_excel.php?date_debut=' . urlencode($dateDebut) . '&date_fin=' . urlencode($dateFin) . '&statut=' . urlencode($statut) . '&type=' . urlencode($type) . '&search=' . urlencode($search)) ?>\" class=\"btn btn-sm btn-success\">"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "utilisateur",
                "user_id",
                "date_start",
                "date_end",
                "range",
                "statut",
                "type",
                "search",
                "prefs",
                "sortBy",
                "sortDir",
                "per_page",
                "where",
                "params",
                "searchTerm",
                "whereSql",
                "orderSql",
                "count_sql",
                "count_stmt",
                "total_count",
                "pagination",
                "sql",
                "stmt",
                "litiges",
                "sqlStats",
                "stmtStats",
                "stats",
                "date_start_input",
                "date_end_input",
                "activeFilters",
                "label",
                "value",
                "litige",
                "badges",
                "badgeClass",
                "typeBadges",
                "typeProbleme",
                "typeBadgeClass"
            ],
            "used": 137
        },
        "coordination\\litiges_synchronisation.php": {
            "problems": [
                {
                    "var": "litige_id",
                    "line": 13,
                    "context": "if (!$litige_id) {"
                },
                {
                    "var": "litige_id",
                    "line": 19,
                    "context": "$data = litiges_charger_complet($pdo, $litige_id);"
                },
                {
                    "var": "coherent_stock",
                    "line": 243,
                    "context": "$icon = $coherent_stock ? 'bi-check-circle text-success' : 'bi-exclamation-circle text-warning';"
                },
                {
                    "var": "coherent_caisse",
                    "line": 263,
                    "context": "$icon = $coherent_caisse ? 'bi-check-circle text-success' : 'bi-exclamation-circle text-warning';"
                },
                {
                    "var": "coherent_compta",
                    "line": 285,
                    "context": "$icon = $coherent_compta ? 'bi-check-circle text-success' : 'bi-exclamation-circle text-warning';"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "data",
                "litige",
                "mouvements_stock",
                "operations_caisse",
                "ecritures_compta",
                "mv",
                "op",
                "ec",
                "icon"
            ],
            "used": 52
        },
        "coordination\\livraisons.php": {
            "problems": [
                {
                    "var": "b",
                    "line": 246,
                    "context": "$livres = array_filter($bls, fn($b) => $b['statut'] === 'LIVRE');"
                },
                {
                    "var": "b",
                    "line": 246,
                    "context": "$livres = array_filter($bls, fn($b) => $b['statut'] === 'LIVRE');"
                },
                {
                    "var": "b",
                    "line": 259,
                    "context": "$enCours = array_filter($bls, fn($b) => in_array($b['statut'], ['EN_PREPARATION','PRET','EN_COURS_LIVRAISON']));"
                },
                {
                    "var": "b",
                    "line": 259,
                    "context": "$enCours = array_filter($bls, fn($b) => in_array($b['statut'], ['EN_PREPARATION','PRET','EN_COURS_LIVRAISON']));"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "statut",
                "date_debut",
                "date_fin",
                "stmt",
                "livreurs",
                "where",
                "params",
                "whereSql",
                "sql",
                "bls",
                "flashSuccess",
                "flashError",
                "s",
                "l",
                "livreur_id",
                "bl",
                "badgeClass",
                "livres",
                "enCours"
            ],
            "used": 56
        },
        "coordination\\verification_synchronisation.php": {
            "problems": [
                {
                    "var": "venteId",
                    "line": 24,
                    "context": "public $venteId;"
                },
                {
                    "var": "venteNumero",
                    "line": 25,
                    "context": "public $venteNumero;"
                },
                {
                    "var": "montantVente",
                    "line": 26,
                    "context": "public $montantVente;"
                },
                {
                    "var": "this",
                    "line": 41,
                    "context": "$venteEntierementLivree = ($this->quantiteLivree >= $this->quantiteCommandee && $this->quantiteCommandee > 0);"
                },
                {
                    "var": "this",
                    "line": 41,
                    "context": "$venteEntierementLivree = ($this->quantiteLivree >= $this->quantiteCommandee && $this->quantiteCommandee > 0);"
                },
                {
                    "var": "this",
                    "line": 41,
                    "context": "$venteEntierementLivree = ($this->quantiteLivree >= $this->quantiteCommandee && $this->quantiteCommandee > 0);"
                },
                {
                    "var": "this",
                    "line": 43,
                    "context": "if (!$venteEntierementLivree && abs($this->montantLivraisons - $this->montantVente) > $tolerance) {"
                },
                {
                    "var": "this",
                    "line": 43,
                    "context": "if (!$venteEntierementLivree && abs($this->montantLivraisons - $this->montantVente) > $tolerance) {"
                },
                {
                    "var": "this",
                    "line": 44,
                    "context": "$ecart = $this->montantLivraisons - $this->montantVente;"
                },
                {
                    "var": "this",
                    "line": 44,
                    "context": "$ecart = $this->montantLivraisons - $this->montantVente;"
                },
                {
                    "var": "this",
                    "line": 45,
                    "context": "$problemes[] = \"Montant livraisons (\" . number_format($this->montantLivraisons, 0, ',', ' ') . \") \u2260 Vente (\" . number_format($this->montantVente, 0, ',', ' ') . \") - \u00c9cart: \" . number_format($ecart, 0, ',', ' ') . \" FCFA\";"
                },
                {
                    "var": "this",
                    "line": 45,
                    "context": "$problemes[] = \"Montant livraisons (\" . number_format($this->montantLivraisons, 0, ',', ' ') . \") \u2260 Vente (\" . number_format($this->montantVente, 0, ',', ' ') . \") - \u00c9cart: \" . number_format($ecart, 0, ',', ' ') . \" FCFA\";"
                },
                {
                    "var": "this",
                    "line": 49,
                    "context": "if ($this->quantiteLivree > $this->quantiteCommandee && $this->quantiteCommandee > 0) {"
                },
                {
                    "var": "this",
                    "line": 49,
                    "context": "if ($this->quantiteLivree > $this->quantiteCommandee && $this->quantiteCommandee > 0) {"
                },
                {
                    "var": "this",
                    "line": 49,
                    "context": "if ($this->quantiteLivree > $this->quantiteCommandee && $this->quantiteCommandee > 0) {"
                },
                {
                    "var": "this",
                    "line": 50,
                    "context": "$problemes[] = \"Quantit\u00e9s livr\u00e9es (\" . $this->quantiteLivree . \") > Command\u00e9es (\" . $this->quantiteCommandee . \") - Surlivraison impossible !\";"
                },
                {
                    "var": "this",
                    "line": 50,
                    "context": "$problemes[] = \"Quantit\u00e9s livr\u00e9es (\" . $this->quantiteLivree . \") > Command\u00e9es (\" . $this->quantiteCommandee . \") - Surlivraison impossible !\";"
                },
                {
                    "var": "this",
                    "line": 54,
                    "context": "if ($this->quantiteStockSortie != $this->quantiteLivree) {"
                },
                {
                    "var": "this",
                    "line": 54,
                    "context": "if ($this->quantiteStockSortie != $this->quantiteLivree) {"
                },
                {
                    "var": "this",
                    "line": 55,
                    "context": "$ecart = $this->quantiteStockSortie - $this->quantiteLivree;"
                },
                {
                    "var": "this",
                    "line": 55,
                    "context": "$ecart = $this->quantiteStockSortie - $this->quantiteLivree;"
                },
                {
                    "var": "this",
                    "line": 56,
                    "context": "$problemes[] = \"Sorties stock (\" . $this->quantiteStockSortie . \") \u2260 Livraisons (\" . $this->quantiteLivree . \") - \u00c9cart: \" . $ecart;"
                },
                {
                    "var": "this",
                    "line": 56,
                    "context": "$problemes[] = \"Sorties stock (\" . $this->quantiteStockSortie . \") \u2260 Livraisons (\" . $this->quantiteLivree . \") - \u00c9cart: \" . $ecart;"
                },
                {
                    "var": "this",
                    "line": 60,
                    "context": "if ($this->ecrituresComptables == 0 && $this->montantVente > 0) {"
                },
                {
                    "var": "this",
                    "line": 60,
                    "context": "if ($this->ecrituresComptables == 0 && $this->montantVente > 0) {"
                },
                {
                    "var": "this",
                    "line": 61,
                    "context": "$problemes[] = \"Aucune \u00e9criture comptable d\u00e9tect\u00e9e (vente de \" . number_format($this->montantVente, 0, ',', ' ') . \" FCFA)\";"
                },
                {
                    "var": "this",
                    "line": 68,
                    "context": "$ok = $this->getCoherence();"
                },
                {
                    "var": "a",
                    "line": 155,
                    "context": "<?= count(array_filter($analyses, fn($a) => $a->getStatus() === 'OK')) ?>"
                },
                {
                    "var": "a",
                    "line": 155,
                    "context": "<?= count(array_filter($analyses, fn($a) => $a->getStatus() === 'OK')) ?>"
                },
                {
                    "var": "a",
                    "line": 165,
                    "context": "<?= count(array_filter($analyses, fn($a) => $a->getStatus() !== 'OK')) ?>"
                },
                {
                    "var": "a",
                    "line": 165,
                    "context": "<?= count(array_filter($analyses, fn($a) => $a->getStatus() !== 'OK')) ?>"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "stmt",
                "ventes",
                "montantLivraisons",
                "montantEncaissements",
                "montantRetours",
                "quantiteCommandee",
                "quantiteLivree",
                "quantiteStockSortie",
                "ecrituresComptables",
                "problemes",
                "tolerance",
                "venteEntierementLivree",
                "ecart",
                "ok",
                "analyses",
                "vente",
                "verif",
                "livr",
                "qliv",
                "enc",
                "ret",
                "stk",
                "ecr",
                "ana",
                "hasError",
                "p",
                "stockCoherent"
            ],
            "used": 122
        },
        "correcteur_automatique.php": {
            "problems": [
                {
                    "var": "dateXX",
                    "line": 38,
                    "context": "// Pattern: htmlspecialchars($dateXX)  sans initialisation"
                },
                {
                    "var": "m",
                    "line": 49,
                    "context": "if (preg_match('/(\\$date_start\\s*=\\s*validateAndFormatDate.*?\\n)/s', $content, $m)) {"
                },
                {
                    "var": "date_end",
                    "line": 56,
                    "context": "'/(\\$date_end\\s*=.*?\\n)/s',"
                },
                {
                    "var": "1",
                    "line": 57,
                    "context": "'$1' . $init,"
                }
            ],
            "requires": [],
            "defined": {
                "0": "corrections",
                "1": "date_start",
                "2": "dateFin",
                "3": "iterator",
                "4": "fixed_files",
                "5": "issues_found",
                "6": "issues_fixed",
                "7": "file",
                "8": "filepath",
                "9": "content",
                "10": "original",
                "11": "has_issue",
                "12": "init",
                "13": "dateDeb",
                "15": "still_broken"
            },
            "used": 51
        },
        "debug_balance_sql.php": {
            "problems": [
                {
                    "var": "carry",
                    "line": 77,
                    "context": "$total_c1 = array_reduce($comptes_c1, function($carry, $item) {"
                },
                {
                    "var": "item",
                    "line": 77,
                    "context": "$total_c1 = array_reduce($comptes_c1, function($carry, $item) {"
                },
                {
                    "var": "carry",
                    "line": 78,
                    "context": "return $carry + ($item['td'] - $item['tc']);"
                },
                {
                    "var": "item",
                    "line": 78,
                    "context": "return $carry + ($item['td'] - $item['tc']);"
                },
                {
                    "var": "item",
                    "line": 78,
                    "context": "return $carry + ($item['td'] - $item['tc']);"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "stmt",
                "2": "ex",
                "3": "exercice_id",
                "4": "balance",
                "5": "totaux1",
                "6": "ligne",
                "7": "solde",
                "8": "classe",
                "9": "c",
                "10": "v",
                "11": "totaux2",
                "14": "comptes_c1",
                "16": "total_c1",
                "17": "i",
                "18": "diff"
            },
            "used": 47
        },
        "debug_final.php": {
            "problems": [
                {
                    "var": "field",
                    "line": 22,
                    "context": "foreach (array_keys($row) as $field) {"
                },
                {
                    "var": "field",
                    "line": 23,
                    "context": "echo \"  - $field\\n\";"
                }
            ],
            "requires": [
                "security.php"
            ],
            "defined": {
                "0": "pdo",
                "1": "utilisateur",
                "3": "stmt",
                "4": "row"
            },
            "used": 10
        },
        "debug_sql.php": {
            "problems": [
                {
                    "var": "is_empty",
                    "line": 14,
                    "context": "echo \"  Segment : \" . substr($stmt, 0, 40) . \"... Empty=$is_empty, Comment=$is_comment\\n\";"
                },
                {
                    "var": "is_empty",
                    "line": 15,
                    "context": "return !$is_empty && substr($stmt, 0, 2) !== '--';"
                }
            ],
            "requires": [],
            "defined": [
                "sql_file",
                "sql_content",
                "statements",
                "queries",
                "stmt",
                "is_comment",
                "q"
            ],
            "used": 14
        },
        "devis\\convertir_en_vente.php": {
            "problems": [
                {
                    "var": "id",
                    "line": 15,
                    "context": "if ($id <= 0) {"
                },
                {
                    "var": "id",
                    "line": 23,
                    "context": "$stmt->execute(['id' => $id]);"
                },
                {
                    "var": "id",
                    "line": 48,
                    "context": "$stmt->execute(['id' => $id]);"
                },
                {
                    "var": "id",
                    "line": 54,
                    "context": "$stmtUpdate->execute(['id' => $id]);"
                },
                {
                    "var": "id",
                    "line": 63,
                    "context": "$stmt->execute(['id' => $id]);"
                },
                {
                    "var": "id",
                    "line": 127,
                    "context": "$stmt->execute(['id' => $id]);"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "appBasePath",
                "devisBasePath",
                "ventesBasePath",
                "stmt",
                "devis",
                "venteExistante",
                "stmtUpdate",
                "lignes",
                "utilisateur",
                "userId",
                "numeroVente",
                "sqlVente",
                "venteId",
                "stmtLigne",
                "l"
            ],
            "used": 45
        },
        "digital\\leads_conversion.php": {
            "problems": [
                {
                    "var": "creer_devis",
                    "line": 105,
                    "context": "if ($creer_devis) {"
                },
                {
                    "var": "creer_devis",
                    "line": 147,
                    "context": "'etape_actuelle' => $creer_devis ? 'DEVIS' : 'PROSPECT',"
                },
                {
                    "var": "creer_devis",
                    "line": 158,
                    "context": "if ($creer_devis) {"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "leadId",
                "stmt",
                "lead",
                "erreurs",
                "stmtTypes",
                "typesClient",
                "csrf",
                "nom",
                "type_client_id",
                "telephone",
                "email",
                "adresse",
                "source",
                "statut",
                "canal_vente_id",
                "sqlClient",
                "stmtClient",
                "clientId",
                "sqlUpdateLead",
                "stmtUpdateLead",
                "devisId",
                "stmtNumero",
                "dernier",
                "prochain",
                "numeroDevis",
                "sqlDevis",
                "stmtDevis",
                "sqlPipeline",
                "stmtPipeline",
                "e",
                "erreur",
                "type"
            ],
            "used": 66
        },
        "digital\\leads_edit.php": {
            "problems": [
                {
                    "var": "leadId",
                    "line": 13,
                    "context": "$isEdit = $leadId > 0;"
                },
                {
                    "var": "leadId",
                    "line": 21,
                    "context": "$stmt->execute([$leadId]);"
                },
                {
                    "var": "leadId",
                    "line": 105,
                    "context": "'id' => $leadId"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "utilisateur",
                "userId",
                "isEdit",
                "erreurs",
                "lead",
                "stmt",
                "csrf",
                "date_lead",
                "nom_prospect",
                "telephone",
                "email",
                "source",
                "message_initial",
                "produit_interet",
                "statut",
                "score_prospect",
                "prochaine_action",
                "date_prochaine_action",
                "campagne",
                "cout_acquisition",
                "observations",
                "utilisateur_responsable_id",
                "sql",
                "e",
                "stmtUsers",
                "utilisateurs",
                "erreur",
                "u"
            ],
            "used": 84
        },
        "execute_sql_complement.php": {
            "problems": [
                {
                    "var": "matches",
                    "line": 27,
                    "context": "preg_match_all($pattern, $sql, $matches);"
                },
                {
                    "var": "matches",
                    "line": 29,
                    "context": "$statements = $matches[0];"
                },
                {
                    "var": "matches",
                    "line": 44,
                    "context": "preg_match('/CREATE TABLE.*?`(\\w+)`/i', $statement, $matches);"
                },
                {
                    "var": "matches",
                    "line": 45,
                    "context": "$tableName = $matches[1] ?? 'inconnue';"
                },
                {
                    "var": "matches",
                    "line": 49,
                    "context": "preg_match('/VIEW\\s+`?(\\w+)`?/i', $statement, $matches);"
                },
                {
                    "var": "matches",
                    "line": 50,
                    "context": "$viewName = $matches[1] ?? 'inconnue';"
                }
            ],
            "requires": [],
            "defined": [
                "sqlFile",
                "sql",
                "pattern",
                "statements",
                "executed",
                "errors",
                "statement",
                "tableName",
                "viewName",
                "e",
                "tables",
                "table",
                "stmt",
                "views",
                "view"
            ],
            "used": 36
        },
        "formation\\formations_edit.php": {
            "problems": [
                {
                    "var": "id",
                    "line": 10,
                    "context": "$editing = $id > 0;"
                },
                {
                    "var": "id",
                    "line": 20,
                    "context": "$stmt->execute(['id' => $id]);"
                },
                {
                    "var": "id",
                    "line": 59,
                    "context": "'id'          => $id,"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "editing",
                "formation",
                "stmt",
                "nom",
                "desc",
                "tarif",
                "errors"
            ],
            "used": 24
        },
        "formation\\inscriptions.php": {
            "problems": [
                {
                    "var": "formationId",
                    "line": 65,
                    "context": "$tarif = (float)$formationsMap[$formationId]['tarif_total'];"
                },
                {
                    "var": "formationId",
                    "line": 105,
                    "context": "'formation_id'     => $formationId,"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "stmt",
                "2": "formations",
                "3": "formationsMap",
                "4": "f",
                "5": "clients",
                "6": "dateInscription",
                "7": "apprenantNom",
                "8": "montantPayeRaw",
                "9": "soldeDuRaw",
                "10": "montantPaye",
                "11": "soldeDu",
                "12": "errors",
                "13": "clientId",
                "14": "tarif",
                "15": "cli",
                "16": "dateDebut",
                "17": "dateFin",
                "18": "where",
                "19": "params",
                "20": "whereSql",
                "21": "sql",
                "22": "inscriptions",
                "23": "flashSuccess",
                "24": "flashError",
                "25": "csrfToken",
                "27": "c",
                "29": "formationFilter",
                "30": "i"
            },
            "used": 73
        },
        "formation\\prospects_list.php": {
            "problems": [
                {
                    "var": "clientId",
                    "line": 49,
                    "context": "'client_id'     => $clientId ?: null,"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "stmtForm",
                "2": "formations",
                "3": "dateProspect",
                "4": "nom",
                "5": "contact",
                "6": "source",
                "7": "statut",
                "8": "errors",
                "9": "stmt",
                "10": "today",
                "11": "firstMonth",
                "12": "dateDeb",
                "13": "dateFin",
                "14": "where",
                "15": "params",
                "16": "whereSql",
                "17": "sql",
                "18": "prospects",
                "19": "flashSuccess",
                "20": "flashError",
                "21": "statuts",
                "22": "s",
                "24": "p"
            },
            "used": 50
        },
        "generer_donnees_coherentes.php": {
            "problems": [
                {
                    "var": "d",
                    "line": 437,
                    "context": "$devisAcceptes = array_filter($devisIds, fn($d) => $d['statut'] === 'ACCEPTE');"
                },
                {
                    "var": "d",
                    "line": 437,
                    "context": "$devisAcceptes = array_filter($devisIds, fn($d) => $d['statut'] === 'ACCEPTE');"
                }
            ],
            "requires": [],
            "defined": {
                "0": "PERIODE_DEBUT",
                "1": "PERIODE_FIN",
                "2": "NB_CLIENTS",
                "3": "NB_PRODUITS",
                "4": "NB_DEVIS",
                "5": "NB_VENTES",
                "6": "NB_ACHATS",
                "7": "stats",
                "8": "typesClient",
                "9": "type",
                "10": "stmt",
                "11": "canauxIds",
                "12": "row",
                "13": "nomsCI",
                "14": "prenoms",
                "15": "villes",
                "16": "quartiers",
                "17": "clientsIds",
                "18": "i",
                "19": "nom",
                "20": "telephone",
                "21": "email",
                "22": "ville",
                "23": "quartier",
                "24": "adresse",
                "25": "typeId",
                "26": "nbProspects",
                "27": "dateProsp",
                "28": "nbLeads",
                "29": "dateLead",
                "30": "fournisseurs",
                "31": "fournisseursIds",
                "32": "f",
                "33": "familles",
                "34": "famillesIds",
                "36": "produits",
                "37": "produitsIds",
                "38": "p",
                "39": "famCode",
                "40": "famId",
                "41": "dateAchat",
                "42": "fournisseurId",
                "43": "numero",
                "44": "achatId",
                "45": "nbLignes",
                "46": "montantTotal",
                "47": "j",
                "48": "produitId",
                "49": "prixAchat",
                "50": "quantite",
                "51": "montantLigne",
                "52": "tva",
                "53": "montantTTC",
                "54": "devisIds",
                "55": "clientId",
                "56": "dateDevis",
                "57": "rand",
                "58": "statut",
                "59": "dateValidite",
                "60": "devisId",
                "61": "produit",
                "62": "prixUnitaire",
                "63": "remise",
                "64": "ventesIds",
                "65": "devisAcceptes",
                "66": "devis",
                "67": "dateVente",
                "68": "devisData",
                "69": "canalId",
                "70": "venteId",
                "71": "lignesDevis",
                "72": "ligne",
                "73": "nbVentesDirectes",
                "74": "vente",
                "75": "dateOrdre",
                "76": "ordreId",
                "77": "dateLivraison",
                "78": "numeroBL",
                "79": "blId",
                "80": "lignesVente",
                "81": "livraisonPartielle",
                "83": "qteLivree",
                "84": "qteRestante",
                "85": "reste",
                "86": "nouveauStatut",
                "87": "ventesLivrees",
                "89": "dateEncaissement",
                "90": "modesPaiement",
                "91": "mode",
                "92": "nbLitiges",
                "93": "ventesAvecLivraison",
                "94": "stockNegatif",
                "95": "nbEcritures",
                "96": "key",
                "97": "value",
                "98": "label",
                "99": "e"
            },
            "used": 330
        },
        "generer_donnees_demo_final.php": {
            "problems": [
                {
                    "var": "d",
                    "line": 166,
                    "context": "$devisAcceptes = array_filter($devisIds, fn($d) => $d['statut'] === 'ACCEPTE');"
                },
                {
                    "var": "d",
                    "line": 166,
                    "context": "$devisAcceptes = array_filter($devisIds, fn($d) => $d['statut'] === 'ACCEPTE');"
                },
                {
                    "var": "ligne",
                    "line": 191,
                    "context": "foreach ($stmt->fetchAll() as $ligne) {"
                },
                {
                    "var": "ligne",
                    "line": 197,
                    "context": "$venteId, $ligne['produit_id'], $ligne['quantite'],"
                },
                {
                    "var": "ligne",
                    "line": 197,
                    "context": "$venteId, $ligne['produit_id'], $ligne['quantite'],"
                },
                {
                    "var": "ligne",
                    "line": 198,
                    "context": "$ligne['prix_unitaire'], $ligne['remise'], $ligne['montant_ligne_ht']"
                },
                {
                    "var": "ligne",
                    "line": 198,
                    "context": "$ligne['prix_unitaire'], $ligne['remise'], $ligne['montant_ligne_ht']"
                },
                {
                    "var": "ligne",
                    "line": 198,
                    "context": "$ligne['prix_unitaire'], $ligne['remise'], $ligne['montant_ligne_ht']"
                },
                {
                    "var": "ligne",
                    "line": 264,
                    "context": "foreach ($stmt->fetchAll() as $ligne) {"
                },
                {
                    "var": "ligne",
                    "line": 270,
                    "context": "$blId, $ligne['produit_id'], $ligne['quantite'], $ligne['quantite']"
                },
                {
                    "var": "ligne",
                    "line": 270,
                    "context": "$blId, $ligne['produit_id'], $ligne['quantite'], $ligne['quantite']"
                },
                {
                    "var": "ligne",
                    "line": 270,
                    "context": "$blId, $ligne['produit_id'], $ligne['quantite'], $ligne['quantite']"
                },
                {
                    "var": "ligne",
                    "line": 275,
                    "context": "'produit_id' => $ligne['produit_id'],"
                },
                {
                    "var": "ligne",
                    "line": 277,
                    "context": "'quantite' => -$ligne['quantite'],"
                }
            ],
            "requires": [],
            "defined": [
                "PERIODE_DEBUT",
                "stats",
                "stmt",
                "canalId",
                "noms",
                "prenoms",
                "clientsIds",
                "i",
                "nom",
                "familles",
                "famillesIds",
                "fam",
                "id",
                "produits",
                "produitsIds",
                "p",
                "prodId",
                "devisIds",
                "clientId",
                "dateDevis",
                "numero",
                "statut",
                "devisId",
                "nbLignes",
                "total",
                "j",
                "prix",
                "qte",
                "montant",
                "ventesIds",
                "devisAcceptes",
                "devis",
                "dateVente",
                "montants",
                "venteId",
                "vente",
                "dateBL",
                "numeroBL",
                "blId",
                "stmtChambres",
                "chambres",
                "chambreId",
                "dateDebut",
                "nbNuits",
                "dateFin",
                "montantTotal",
                "stmtFormations",
                "formations",
                "formationId",
                "dateInscription",
                "montantPaye",
                "soldeDu",
                "nomClient",
                "nomComplet",
                "dateEnc",
                "modes",
                "negatif",
                "ventesZero",
                "k",
                "v",
                "e",
                "msg"
            ],
            "used": 224
        },
        "generer_donnees_demo_simple.php": {
            "problems": [
                {
                    "var": "d",
                    "line": 162,
                    "context": "$devisAcceptes = array_filter($devisIds, fn($d) => $d['statut'] === 'ACCEPTE');"
                },
                {
                    "var": "d",
                    "line": 162,
                    "context": "$devisAcceptes = array_filter($devisIds, fn($d) => $d['statut'] === 'ACCEPTE');"
                },
                {
                    "var": "ligne",
                    "line": 187,
                    "context": "foreach ($stmt->fetchAll() as $ligne) {"
                },
                {
                    "var": "ligne",
                    "line": 193,
                    "context": "$venteId, $ligne['produit_id'], $ligne['designation'],"
                },
                {
                    "var": "ligne",
                    "line": 193,
                    "context": "$venteId, $ligne['produit_id'], $ligne['designation'],"
                },
                {
                    "var": "ligne",
                    "line": 194,
                    "context": "$ligne['quantite'], $ligne['prix_unitaire'], $ligne['remise'], $ligne['montant_ligne_ht']"
                },
                {
                    "var": "ligne",
                    "line": 194,
                    "context": "$ligne['quantite'], $ligne['prix_unitaire'], $ligne['remise'], $ligne['montant_ligne_ht']"
                },
                {
                    "var": "ligne",
                    "line": 194,
                    "context": "$ligne['quantite'], $ligne['prix_unitaire'], $ligne['remise'], $ligne['montant_ligne_ht']"
                },
                {
                    "var": "ligne",
                    "line": 194,
                    "context": "$ligne['quantite'], $ligne['prix_unitaire'], $ligne['remise'], $ligne['montant_ligne_ht']"
                },
                {
                    "var": "ligne",
                    "line": 260,
                    "context": "foreach ($stmt->fetchAll() as $ligne) {"
                },
                {
                    "var": "ligne",
                    "line": 267,
                    "context": "$blId, $ligne['produit_id'], $ligne['designation'],"
                },
                {
                    "var": "ligne",
                    "line": 267,
                    "context": "$blId, $ligne['produit_id'], $ligne['designation'],"
                },
                {
                    "var": "ligne",
                    "line": 268,
                    "context": "$ligne['quantite'], $ligne['quantite'], $ligne['prix_unitaire']"
                },
                {
                    "var": "ligne",
                    "line": 268,
                    "context": "$ligne['quantite'], $ligne['quantite'], $ligne['prix_unitaire']"
                },
                {
                    "var": "ligne",
                    "line": 268,
                    "context": "$ligne['quantite'], $ligne['quantite'], $ligne['prix_unitaire']"
                },
                {
                    "var": "ligne",
                    "line": 273,
                    "context": "'produit_id' => $ligne['produit_id'],"
                },
                {
                    "var": "ligne",
                    "line": 275,
                    "context": "'quantite' => -$ligne['quantite'],"
                }
            ],
            "requires": [],
            "defined": [
                "PERIODE_DEBUT",
                "stats",
                "nomsCI",
                "prenoms",
                "clientsIds",
                "i",
                "nom",
                "stmt",
                "familles",
                "famillesIds",
                "fam",
                "id",
                "produits",
                "produitsIds",
                "p",
                "prodId",
                "canalDevisId",
                "devisIds",
                "clientId",
                "dateDevis",
                "numero",
                "statut",
                "devisId",
                "nbLignes",
                "total",
                "j",
                "prod",
                "qte",
                "montant",
                "canalId",
                "ventesIds",
                "devisAcceptes",
                "devis",
                "dateVente",
                "montants",
                "venteId",
                "vente",
                "dateBL",
                "numeroBL",
                "blId",
                "dateEnc",
                "modes",
                "negatif",
                "k",
                "v",
                "e"
            ],
            "used": 181
        },
        "generer_donnees_demo_v2.php": {
            "problems": [
                {
                    "var": "d",
                    "line": 312,
                    "context": "$devisAcceptes = array_filter($devisIds, fn($d) => $d['statut'] === 'ACCEPTE');"
                },
                {
                    "var": "d",
                    "line": 312,
                    "context": "$devisAcceptes = array_filter($devisIds, fn($d) => $d['statut'] === 'ACCEPTE');"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "produitId",
                "2": "type",
                "3": "quantite",
                "4": "commentaire",
                "5": "userId",
                "6": "sourceId",
                "7": "sourceType",
                "8": "PERIODE_DEBUT",
                "9": "PERIODE_FIN",
                "10": "stats",
                "11": "stmt",
                "12": "canaux",
                "13": "row",
                "14": "nomsCI",
                "15": "prenoms",
                "16": "sources",
                "17": "statuts",
                "18": "clientsIds",
                "19": "i",
                "20": "nom",
                "21": "telephone",
                "22": "email",
                "23": "adresse",
                "24": "fournisseurs",
                "25": "fournisseursIds",
                "26": "f",
                "27": "famillesNecessaires",
                "28": "famillesIds",
                "29": "fam",
                "30": "existId",
                "31": "produits",
                "32": "produitsIds",
                "33": "p",
                "34": "familleId",
                "35": "prodId",
                "36": "dateAchat",
                "37": "numero",
                "38": "fournisseur",
                "39": "achatId",
                "40": "nbLignes",
                "41": "montantTotal",
                "42": "j",
                "43": "prixAchat",
                "44": "qte",
                "45": "montant",
                "46": "devisIds",
                "47": "clientId",
                "48": "dateDevis",
                "49": "rand",
                "50": "statut",
                "51": "devisId",
                "52": "total",
                "53": "prod",
                "54": "prix",
                "55": "remise",
                "56": "tva",
                "57": "ventesIds",
                "58": "devisAcceptes",
                "59": "devis",
                "60": "dateVente",
                "61": "devisData",
                "62": "venteId",
                "63": "nbDirectes",
                "64": "canalKeys",
                "65": "canalId",
                "66": "vente",
                "67": "dateOrdre",
                "68": "ordreId",
                "69": "dateBL",
                "70": "numeroBL",
                "71": "blId",
                "72": "lignesVente",
                "73": "partielle",
                "74": "ligne",
                "75": "qteLivree",
                "76": "reste",
                "77": "ventesLivrees",
                "79": "dateEnc",
                "80": "modes",
                "81": "nbNegatif",
                "82": "key",
                "83": "val",
                "84": "e"
            },
            "used": 296
        },
        "hotel\\chambres_edit.php": {
            "problems": [
                {
                    "var": "id",
                    "line": 10,
                    "context": "$isEdit = $id > 0;"
                },
                {
                    "var": "id",
                    "line": 23,
                    "context": "$stmt->execute(['id' => $id]);"
                },
                {
                    "var": "actif",
                    "line": 63,
                    "context": "'actif' => $actif,"
                },
                {
                    "var": "id",
                    "line": 64,
                    "context": "'id'    => $id,"
                },
                {
                    "var": "actif",
                    "line": 76,
                    "context": "'actif' => $actif,"
                },
                {
                    "var": "actif",
                    "line": 88,
                    "context": "$chambre['actif']       = $actif;"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "isEdit",
                "errors",
                "chambre",
                "stmt",
                "code",
                "description",
                "tarif",
                "e"
            ],
            "used": 34
        },
        "hotel\\reservation_edit.php": {
            "problems": [
                {
                    "var": "id",
                    "line": 10,
                    "context": "$isEdit = $id > 0;"
                },
                {
                    "var": "id",
                    "line": 38,
                    "context": "$stmt->execute(['id' => $id]);"
                },
                {
                    "var": "modePaiementId",
                    "line": 125,
                    "context": "'mode_paiement_id' => $modePaiementId,"
                },
                {
                    "var": "id",
                    "line": 127,
                    "context": "'id'               => $id,"
                },
                {
                    "var": "id",
                    "line": 129,
                    "context": "$reservationId = $id;"
                },
                {
                    "var": "modePaiementId",
                    "line": 148,
                    "context": "'mode_paiement_id' => $modePaiementId,"
                },
                {
                    "var": "enregistrerCaisse",
                    "line": 156,
                    "context": "if ($enregistrerCaisse && $modePaiementId && $montantTotal > 0) {"
                },
                {
                    "var": "modePaiementId",
                    "line": 156,
                    "context": "if ($enregistrerCaisse && $modePaiementId && $montantTotal > 0) {"
                },
                {
                    "var": "modePaiementId",
                    "line": 171,
                    "context": "'mode_paiement_id' => $modePaiementId,"
                },
                {
                    "var": "modePaiementId",
                    "line": 190,
                    "context": "$reservation['mode_paiement_id'] = $modePaiementId;"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "isEdit",
                "2": "errors",
                "3": "stmt",
                "4": "clients",
                "5": "chambres",
                "6": "modesPaiement",
                "7": "reservation",
                "8": "clientId",
                "9": "chambreId",
                "10": "dateDeb",
                "11": "dateFin",
                "12": "statut",
                "13": "nbNuits",
                "14": "d1",
                "15": "d2",
                "16": "e",
                "17": "tarifNuite",
                "18": "rowTarif",
                "19": "montantTotal",
                "20": "reservationId",
                "22": "cl",
                "23": "ch",
                "24": "s",
                "25": "mp",
                "26": "tarifsParChambre"
            },
            "used": 105
        },
        "lib\\cache.php": {
            "problems": [
                {
                    "var": "this",
                    "line": 22,
                    "context": "if (!is_dir($this->cache_dir)) {"
                },
                {
                    "var": "this",
                    "line": 23,
                    "context": "@mkdir($this->cache_dir, 0755, true);"
                },
                {
                    "var": "this",
                    "line": 29,
                    "context": "$this->redis = new Redis();"
                },
                {
                    "var": "this",
                    "line": 34,
                    "context": "if ($this->redis->connect($host, $port, $timeout)) {"
                },
                {
                    "var": "this",
                    "line": 35,
                    "context": "$this->use_redis = true;"
                },
                {
                    "var": "this",
                    "line": 38,
                    "context": "$this->redis = null;"
                },
                {
                    "var": "this",
                    "line": 39,
                    "context": "$this->use_redis = false;"
                },
                {
                    "var": "this",
                    "line": 51,
                    "context": "if ($this->use_redis && $this->redis) {"
                },
                {
                    "var": "this",
                    "line": 51,
                    "context": "if ($this->use_redis && $this->redis) {"
                },
                {
                    "var": "this",
                    "line": 53,
                    "context": "$value = $this->redis->get($this->getKey($key));"
                },
                {
                    "var": "this",
                    "line": 53,
                    "context": "$value = $this->redis->get($this->getKey($key));"
                },
                {
                    "var": "this",
                    "line": 63,
                    "context": "return $this->getFromFile($key);"
                },
                {
                    "var": "this",
                    "line": 80,
                    "context": "if ($this->use_redis && $this->redis) {"
                },
                {
                    "var": "this",
                    "line": 80,
                    "context": "if ($this->use_redis && $this->redis) {"
                },
                {
                    "var": "this",
                    "line": 82,
                    "context": "$this->redis->setex($this->getKey($key), $ttl, $serialized);"
                },
                {
                    "var": "this",
                    "line": 82,
                    "context": "$this->redis->setex($this->getKey($key), $ttl, $serialized);"
                },
                {
                    "var": "this",
                    "line": 90,
                    "context": "return $this->setToFile($key, $serialized, $ttl) || $success;"
                },
                {
                    "var": "this",
                    "line": 101,
                    "context": "if ($this->use_redis && $this->redis) {"
                },
                {
                    "var": "this",
                    "line": 101,
                    "context": "if ($this->use_redis && $this->redis) {"
                },
                {
                    "var": "this",
                    "line": 103,
                    "context": "$this->redis->del($this->getKey($key));"
                },
                {
                    "var": "this",
                    "line": 103,
                    "context": "$this->redis->del($this->getKey($key));"
                },
                {
                    "var": "this",
                    "line": 111,
                    "context": "$file = $this->getFilePath($key);"
                },
                {
                    "var": "this",
                    "line": 127,
                    "context": "if ($this->use_redis && $this->redis) {"
                },
                {
                    "var": "this",
                    "line": 127,
                    "context": "if ($this->use_redis && $this->redis) {"
                },
                {
                    "var": "this",
                    "line": 130,
                    "context": "$keys = $this->redis->keys('kms_*');"
                },
                {
                    "var": "this",
                    "line": 132,
                    "context": "$this->redis->del($keys);"
                },
                {
                    "var": "this",
                    "line": 141,
                    "context": "$files = glob($this->cache_dir . '/*.cache');"
                },
                {
                    "var": "this",
                    "line": 154,
                    "context": "$files = glob($this->cache_dir . '/*.cache');"
                },
                {
                    "var": "this",
                    "line": 165,
                    "context": "'redis_connected' => $this->use_redis,"
                },
                {
                    "var": "this",
                    "line": 166,
                    "context": "'cache_dir' => $this->cache_dir"
                },
                {
                    "var": "this",
                    "line": 179,
                    "context": "$value = $this->get($key);"
                },
                {
                    "var": "this",
                    "line": 184,
                    "context": "$this->set($key, $value, $ttl);"
                },
                {
                    "var": "this",
                    "line": 201,
                    "context": "return $this->cache_dir . '/' . $safe_key . '.cache';"
                },
                {
                    "var": "this",
                    "line": 205,
                    "context": "$file = $this->getFilePath($key);"
                },
                {
                    "var": "this",
                    "line": 213,
                    "context": "if ($mtime + $this->ttl < time()) {"
                },
                {
                    "var": "this",
                    "line": 228,
                    "context": "$file = $this->getFilePath($key);"
                }
            ],
            "requires": [],
            "defined": {
                "0": "redis",
                "1": "cache_dir",
                "2": "ttl",
                "3": "use_redis",
                "4": "config",
                "6": "host",
                "7": "port",
                "8": "timeout",
                "9": "e",
                "10": "key",
                "11": "value",
                "16": "serialized",
                "17": "success",
                "21": "file",
                "22": "keys",
                "24": "files",
                "26": "size",
                "29": "callback",
                "33": "safe_key",
                "35": "mtime",
                "36": "content"
            },
            "used": 98
        },
        "lib\\caisse.php": {
            "problems": [
                {
                    "var": "montant",
                    "line": 27,
                    "context": "float $montant,"
                },
                {
                    "var": "montant",
                    "line": 100,
                    "context": "':montant' => $montant,"
                }
            ],
            "requires": [],
            "defined": {
                "0": "sens",
                "1": "s",
                "2": "source_type",
                "3": "source_id",
                "4": "commentaire",
                "5": "utilisateur_id",
                "6": "date_operation",
                "7": "numero_piece",
                "8": "mode_paiement_id",
                "9": "type_operation",
                "10": "vente_id",
                "11": "reservation_id",
                "12": "inscription_formation_id",
                "13": "client_id",
                "14": "fournisseur_id",
                "15": "sensNorm",
                "16": "dateOp",
                "17": "numero",
                "18": "typeOp",
                "19": "modePaiementId",
                "20": "responsableId",
                "21": "sql",
                "22": "stmt",
                "23": "pdo",
                "24": "id",
                "25": "annule_par_id",
                "27": "date_debut",
                "28": "date_fin",
                "29": "params",
                "30": "row",
                "32": "limit"
            },
            "used": 49
        },
        "lib\\compta.php": {
            "problems": [
                {
                    "var": "date_piece",
                    "line": 50,
                    "context": "string $date_piece,"
                },
                {
                    "var": "date_piece",
                    "line": 67,
                    "context": "$exercice_id, $journal_id, $numero_piece, $date_piece,"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "stmt",
                "3": "journal_id",
                "4": "exercice_id",
                "5": "result",
                "6": "journal_code",
                "7": "numero",
                "8": "reference_type",
                "9": "reference_id",
                "10": "tiers_client_id",
                "11": "tiers_fournisseur_id",
                "12": "observations",
                "13": "numero_piece",
                "14": "montant_debit",
                "15": "montant_credit",
                "16": "libelle",
                "17": "centre_analytique_id",
                "18": "ordre",
                "20": "source_type",
                "21": "code_operation",
                "23": "vente_id",
                "24": "vente",
                "25": "mapping",
                "26": "exercice",
                "27": "piece_id",
                "28": "montant_ttc",
                "29": "e",
                "31": "achat_id",
                "32": "achat",
                "35": "journal_caisse_id",
                "36": "caisse",
                "37": "montant",
                "39": "date_debut",
                "40": "date_fin",
                "41": "limit",
                "42": "params",
                "43": "where",
                "44": "sql",
                "48": "compte_id"
            },
            "used": 210
        },
        "lib\\date_helpers.php": {
            "problems": [
                {
                    "var": "start_str",
                    "line": 44,
                    "context": "[$start_str, $end_str] = explode(',', $preset);"
                },
                {
                    "var": "end_str",
                    "line": 44,
                    "context": "[$start_str, $end_str] = explode(',', $preset);"
                },
                {
                    "var": "start_str",
                    "line": 46,
                    "context": "'start' => trim($start_str),"
                },
                {
                    "var": "end_str",
                    "line": 47,
                    "context": "'end' => trim($end_str)"
                }
            ],
            "requires": [],
            "defined": {
                "0": "preset",
                "1": "today",
                "2": "start",
                "3": "end",
                "4": "date_str",
                "5": "is_end_date",
                "6": "date",
                "7": "e",
                "8": "column",
                "9": "date_start",
                "10": "date_end",
                "11": "where",
                "13": "format",
                "16": "presets",
                "17": "p"
            },
            "used": 50
        },
        "lib\\email_2fa.php": {
            "problems": [
                {
                    "var": "this",
                    "line": 12,
                    "context": "$this->pdo = $pdo;"
                },
                {
                    "var": "this",
                    "line": 27,
                    "context": "$stmt = $this->pdo->prepare(\""
                },
                {
                    "var": "this",
                    "line": 49,
                    "context": "$stmt = $this->pdo->prepare(\""
                },
                {
                    "var": "this",
                    "line": 65,
                    "context": "$stmt = $this->pdo->prepare(\""
                },
                {
                    "var": "this",
                    "line": 77,
                    "context": "$stmt = $this->pdo->prepare(\""
                }
            ],
            "requires": [],
            "defined": {
                "0": "codeExpiration",
                "1": "pdo",
                "2": "userId",
                "3": "email",
                "4": "stmt",
                "5": "e",
                "11": "code",
                "15": "userName",
                "16": "subject",
                "17": "message",
                "18": "headers",
                "19": "sent"
            },
            "used": 36
        },
        "lib\\kpi_cache.php": {
            "problems": [
                {
                    "var": "this",
                    "line": 22,
                    "context": "$this->pdo = $pdo;"
                },
                {
                    "var": "this",
                    "line": 23,
                    "context": "$this->cache = getCache();"
                },
                {
                    "var": "this",
                    "line": 31,
                    "context": "return $this->remember('kpi_ca_today', 'daily', function() {"
                },
                {
                    "var": "this",
                    "line": 40,
                    "context": "$result = $this->pdo->query($sql)->fetch(PDO::FETCH_ASSOC);"
                },
                {
                    "var": "this",
                    "line": 53,
                    "context": "return $this->remember('kpi_ca_month', 'monthly', function() {"
                },
                {
                    "var": "this",
                    "line": 63,
                    "context": "$result = $this->pdo->query($sql)->fetch(PDO::FETCH_ASSOC);"
                },
                {
                    "var": "this",
                    "line": 76,
                    "context": "return $this->remember('kpi_ca_year', 'yearly', function() {"
                },
                {
                    "var": "this",
                    "line": 85,
                    "context": "$result = $this->pdo->query($sql)->fetch(PDO::FETCH_ASSOC);"
                },
                {
                    "var": "this",
                    "line": 98,
                    "context": "return $this->remember('kpi_active_clients_month', 'monthly', function() {"
                },
                {
                    "var": "this",
                    "line": 106,
                    "context": "return (int)($this->pdo->query($sql)->fetch()['cnt'] ?? 0);"
                },
                {
                    "var": "this",
                    "line": 115,
                    "context": "return $this->remember('kpi_ruptures', 'realtime', function() {"
                },
                {
                    "var": "this",
                    "line": 122,
                    "context": "return (int)($this->pdo->query($sql)->fetch()['cnt'] ?? 0);"
                },
                {
                    "var": "this",
                    "line": 131,
                    "context": "return $this->remember('kpi_encaissement_month', 'realtime', function() {"
                },
                {
                    "var": "this",
                    "line": 141,
                    "context": "$result = $this->pdo->query($sql)->fetch(PDO::FETCH_ASSOC);"
                },
                {
                    "var": "this",
                    "line": 159,
                    "context": "return $this->remember('kpi_top_clients_month', 'monthly', function() use ($limit) {"
                },
                {
                    "var": "this",
                    "line": 175,
                    "context": "$stmt = $this->pdo->prepare($sql);"
                },
                {
                    "var": "this",
                    "line": 186,
                    "context": "return $this->remember('kpi_non_livrees', 'realtime', function() {"
                },
                {
                    "var": "this",
                    "line": 192,
                    "context": "return (int)($this->pdo->query($sql)->fetch()['cnt'] ?? 0);"
                },
                {
                    "var": "this",
                    "line": 202,
                    "context": "'ca_today' => $this->getCAToday(),"
                },
                {
                    "var": "this",
                    "line": 203,
                    "context": "'ca_month' => $this->getCAMonth(),"
                },
                {
                    "var": "this",
                    "line": 204,
                    "context": "'ca_year' => $this->getCAYear(),"
                },
                {
                    "var": "this",
                    "line": 205,
                    "context": "'active_clients' => $this->getActiveClientsMonth(),"
                },
                {
                    "var": "this",
                    "line": 206,
                    "context": "'ruptures' => $this->getStockRuptures(),"
                },
                {
                    "var": "this",
                    "line": 207,
                    "context": "'encaissement' => $this->getEncaissementMonth(),"
                },
                {
                    "var": "this",
                    "line": 208,
                    "context": "'top_clients' => $this->getTopClientsMonth(5),"
                },
                {
                    "var": "this",
                    "line": 209,
                    "context": "'non_livrees' => $this->getNonLivr\u00e9es(),"
                },
                {
                    "var": "this",
                    "line": 231,
                    "context": "$this->cache->delete($key);"
                },
                {
                    "var": "this",
                    "line": 244,
                    "context": "return $this->cache->delete($key);"
                },
                {
                    "var": "this",
                    "line": 257,
                    "context": "$ttl = $this->ttls[$ttl_type] ?? 3600;"
                },
                {
                    "var": "this",
                    "line": 258,
                    "context": "$value = $this->cache->get($key);"
                },
                {
                    "var": "this",
                    "line": 262,
                    "context": "$this->cache->set($key, $value, $ttl);"
                }
            ],
            "requires": [],
            "defined": {
                "0": "cache",
                "1": "pdo",
                "2": "ttls",
                "4": "sql",
                "5": "result",
                "6": "total",
                "7": "encaisse",
                "8": "limit",
                "9": "stmt",
                "10": "keys",
                "11": "key",
                "12": "kpi_name",
                "14": "ttl_type",
                "15": "callback",
                "16": "ttl",
                "17": "value"
            },
            "used": 70
        },
        "lib\\litiges.php": {
            "problems": [
                {
                    "var": "type_probleme",
                    "line": 19,
                    "context": "function litiges_creer_avec_retour($pdo, $client_id, $produit_id, $vente_id, $type_probleme,"
                },
                {
                    "var": "motif_detaille",
                    "line": 20,
                    "context": "$motif_detaille, $responsable_id, $options = []) {"
                },
                {
                    "var": "responsable_id",
                    "line": 20,
                    "context": "$motif_detaille, $responsable_id, $options = []) {"
                },
                {
                    "var": "motif_detaille",
                    "line": 39,
                    "context": "'motif'          => $motif_detaille,"
                },
                {
                    "var": "type_probleme",
                    "line": 40,
                    "context": "'type_probleme'  => $type_probleme,"
                },
                {
                    "var": "responsable_id",
                    "line": 41,
                    "context": "'responsable_id' => $responsable_id,"
                },
                {
                    "var": "motif_detaille",
                    "line": 54,
                    "context": "'commentaire'     => \"Retour client - Litige #{$litige_id} - {$motif_detaille}\","
                },
                {
                    "var": "responsable_id",
                    "line": 57,
                    "context": "'utilisateur_id'  => $responsable_id,"
                },
                {
                    "var": "montant_rembourse",
                    "line": 76,
                    "context": "function litiges_resoudre_avec_remboursement($pdo, $litige_id, $montant_rembourse,"
                },
                {
                    "var": "solution",
                    "line": 77,
                    "context": "$solution, $options = []) {"
                },
                {
                    "var": "montant_rembourse",
                    "line": 97,
                    "context": "$montant_rembourse,"
                },
                {
                    "var": "montant_rembourse",
                    "line": 138,
                    "context": "$montant_rembourse,"
                },
                {
                    "var": "montant_rembourse",
                    "line": 151,
                    "context": "$montant_rembourse,"
                },
                {
                    "var": "solution",
                    "line": 169,
                    "context": "'solution'        => $solution,"
                },
                {
                    "var": "montant_rembourse",
                    "line": 170,
                    "context": "'montant'         => $montant_rembourse,"
                },
                {
                    "var": "montant_rembourse",
                    "line": 179,
                    "context": "'message' => \"Remboursement enregistr\u00e9 : {$montant_rembourse} FCFA\""
                },
                {
                    "var": "quantite_remplacement",
                    "line": 188,
                    "context": "function litiges_resoudre_avec_remplacement($pdo, $litige_id, $quantite_remplacement,"
                },
                {
                    "var": "solution",
                    "line": 189,
                    "context": "$solution, $options = []) {"
                },
                {
                    "var": "quantite_remplacement",
                    "line": 211,
                    "context": "'quantite'        => $quantite_remplacement,"
                },
                {
                    "var": "quantite_remplacement",
                    "line": 225,
                    "context": "'quantite'        => $quantite_remplacement,"
                },
                {
                    "var": "solution",
                    "line": 242,
                    "context": "'solution'        => $solution,"
                },
                {
                    "var": "quantite_remplacement",
                    "line": 251,
                    "context": "'message' => \"Remplacement enregistr\u00e9 : {$quantite_remplacement} unit\u00e9s\""
                },
                {
                    "var": "montant_avoir",
                    "line": 260,
                    "context": "function litiges_resoudre_avec_avoir($pdo, $litige_id, $montant_avoir,"
                },
                {
                    "var": "solution",
                    "line": 261,
                    "context": "$solution, $options = []) {"
                },
                {
                    "var": "montant_avoir",
                    "line": 307,
                    "context": "$montant_avoir,"
                },
                {
                    "var": "montant_avoir",
                    "line": 320,
                    "context": "$montant_avoir,"
                },
                {
                    "var": "solution",
                    "line": 338,
                    "context": "'solution'        => $solution,"
                },
                {
                    "var": "montant_avoir",
                    "line": 339,
                    "context": "'montant'         => $montant_avoir,"
                },
                {
                    "var": "montant_avoir",
                    "line": 348,
                    "context": "'message' => \"Avoir accord\u00e9 : {$montant_avoir} FCFA\""
                }
            ],
            "requires": [],
            "defined": {
                "0": "options",
                "1": "date_retour",
                "2": "quantite_retournee",
                "3": "stmt",
                "4": "litige_id",
                "5": "e",
                "6": "utilisateur_id",
                "7": "date_resolution",
                "8": "litige",
                "9": "client_id",
                "10": "vente_id",
                "11": "exercice",
                "12": "numero_piece",
                "13": "piece_id",
                "16": "produit_id",
                "20": "pdo",
                "22": "raison_abandon",
                "27": "mouvements_stock",
                "28": "operations_caisse",
                "29": "ecritures_compta"
            },
            "used": 150
        },
        "lib\\query_optimizer.php": {
            "problems": [
                {
                    "var": "this",
                    "line": 13,
                    "context": "$this->pdo = $pdo;"
                },
                {
                    "var": "this",
                    "line": 26,
                    "context": "$stmt = $this->pdo->prepare($sql);"
                },
                {
                    "var": "this",
                    "line": 32,
                    "context": "if ($duration > $this->slow_query_threshold) {"
                },
                {
                    "var": "this",
                    "line": 33,
                    "context": "$this->logSlowQuery($sql, $params, $duration);"
                },
                {
                    "var": "this",
                    "line": 49,
                    "context": "$stmt = $this->pdo->query($sql);"
                },
                {
                    "var": "this",
                    "line": 67,
                    "context": "$stmt = $this->pdo->query($explain_sql);"
                },
                {
                    "var": "this",
                    "line": 89,
                    "context": "$stmt = $this->pdo->prepare($sql);"
                },
                {
                    "var": "this",
                    "line": 115,
                    "context": "$stmt = $this->pdo->prepare($check);"
                },
                {
                    "var": "this",
                    "line": 122,
                    "context": "$indexes = $this->analyzeTableIndexes($table);"
                },
                {
                    "var": "this",
                    "line": 214,
                    "context": "$this->slow_query_threshold = $seconds;"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "slow_query_threshold",
                "2": "queries_log",
                "4": "sql",
                "5": "params",
                "6": "start",
                "7": "stmt",
                "8": "duration",
                "9": "e",
                "10": "table",
                "11": "indexes",
                "12": "result",
                "13": "idx",
                "15": "explain_sql",
                "16": "database",
                "17": "suggestions",
                "18": "tables_and_columns",
                "20": "columns",
                "21": "check",
                "22": "col",
                "23": "has_index",
                "24": "idx_name",
                "25": "idx_cols",
                "26": "query",
                "27": "join_count",
                "31": "log_file",
                "32": "logs_dir",
                "33": "log_entry",
                "34": "limit",
                "35": "lines",
                "36": "seconds"
            },
            "used": 79
        },
        "litiges\\edit.php": {
            "problems": [
                {
                    "var": "id",
                    "line": 10,
                    "context": "$isEdit = $id > 0;"
                },
                {
                    "var": "id",
                    "line": 37,
                    "context": "$stmt->execute(['id' => $id]);"
                },
                {
                    "var": "id",
                    "line": 114,
                    "context": "'id'                 => $id,"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "isEdit",
                "stmt",
                "clients",
                "produits",
                "utilisateurs",
                "data",
                "row",
                "errors",
                "e",
                "err",
                "cl",
                "pr",
                "u",
                "s"
            ],
            "used": 82
        },
        "livraisons\\export_excel.php": {
            "problems": [
                {
                    "var": "clientId",
                    "line": 28,
                    "context": "if ($clientId > 0) {"
                },
                {
                    "var": "clientId",
                    "line": 30,
                    "context": "$params[':client_id'] = $clientId;"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "dateDebut",
                "dateFin",
                "statut",
                "signe",
                "where",
                "params",
                "sql",
                "stmt",
                "bons",
                "output",
                "b"
            ],
            "used": 32
        },
        "livraisons\\list.php": {
            "problems": [
                {
                    "var": "dateDeb",
                    "line": 182,
                    "context": "value=\"<?= htmlspecialchars($dateDeb) ?>\">"
                },
                {
                    "var": "dateFin",
                    "line": 187,
                    "context": "value=\"<?= htmlspecialchars($dateFin) ?>\">"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "utilisateur",
                "user_id",
                "date_start",
                "date_end",
                "range",
                "signe",
                "search",
                "prefs",
                "sortBy",
                "sortDir",
                "per_page",
                "clients",
                "where",
                "params",
                "searchTerm",
                "whereSql",
                "orderSql",
                "count_sql",
                "count_stmt",
                "total_count",
                "pagination",
                "sql",
                "stmt",
                "bons",
                "flashSuccess",
                "flashError",
                "date_start_input",
                "date_end_input",
                "cl",
                "clientId",
                "activeFilters",
                "clientName",
                "c",
                "label",
                "value",
                "b"
            ],
            "used": 102
        },
        "livraisons\\marquer_signe.php": {
            "problems": [
                {
                    "var": "blId",
                    "line": 18,
                    "context": "if ($blId <= 0) {"
                },
                {
                    "var": "blId",
                    "line": 23,
                    "context": "$stmt->execute(['id' => $blId]);"
                },
                {
                    "var": "blId",
                    "line": 38,
                    "context": "$stmt->execute(['id' => $blId]);"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "stmt",
                "bl",
                "e"
            ],
            "used": 9
        },
        "livraisons\\modal_signature.php": {
            "problems": [
                {
                    "var": "bl",
                    "line": 18,
                    "context": "<small>BL #<?= htmlspecialchars($bl['numero']) ?> \u2013 <?= htmlspecialchars($bl['client_nom']) ?></small>"
                },
                {
                    "var": "bl",
                    "line": 18,
                    "context": "<small>BL #<?= htmlspecialchars($bl['numero']) ?> \u2013 <?= htmlspecialchars($bl['client_nom']) ?></small>"
                },
                {
                    "var": "bl",
                    "line": 100,
                    "context": "blId: <?= (int)$bl['id'] ?>,"
                },
                {
                    "var": "bl",
                    "line": 102,
                    "context": "detailUrl: '<?= url_for('livraisons/detail.php?id=' . (int)$bl['id']) ?>',"
                }
            ],
            "requires": [],
            "defined": [],
            "used": 4
        },
        "login.php": {
            "problems": [
                {
                    "var": "succes",
                    "line": 224,
                    "context": "bool $succes,"
                },
                {
                    "var": "succes",
                    "line": 240,
                    "context": "$succes ? 1 : 0,"
                }
            ],
            "requires": [],
            "defined": {
                "0": "scriptPath",
                "1": "basePath",
                "2": "dashboardUrl",
                "3": "erreur",
                "4": "etape",
                "5": "userId2FA",
                "6": "csrf",
                "7": "login",
                "8": "motDePasse",
                "9": "ip",
                "10": "rateLimitCheck",
                "11": "pdo",
                "13": "stmt",
                "14": "user",
                "15": "userId",
                "16": "email2FA",
                "17": "code",
                "18": "emailBackup",
                "19": "result",
                "20": "code2FA",
                "22": "csrfToken",
                "27": "upd",
                "30": "sessionId",
                "31": "userAgent",
                "32": "expirationMinutes",
                "33": "e",
                "34": "raisonEchec",
                "35": "methode2FA"
            },
            "used": 82
        },
        "migrate_compta.php": {
            "problems": [
                {
                    "var": "m",
                    "line": 42,
                    "context": "preg_match('/CREATE TABLE IF NOT EXISTS\\s+(\\w+)/i', $query, $m);"
                },
                {
                    "var": "m",
                    "line": 43,
                    "context": "echo \"\u2713 CREATE TABLE : \" . ($m[1] ?? 'unknown') . \"\\n\";"
                },
                {
                    "var": "m",
                    "line": 45,
                    "context": "preg_match('/ALTER TABLE\\s+(\\w+)/i', $query, $m);"
                },
                {
                    "var": "m",
                    "line": 46,
                    "context": "echo \"\u2713 ALTER TABLE : \" . ($m[1] ?? 'unknown') . \"\\n\";"
                },
                {
                    "var": "m",
                    "line": 48,
                    "context": "preg_match('/INSERT INTO\\s+(\\w+)/i', $query, $m);"
                },
                {
                    "var": "m",
                    "line": 49,
                    "context": "echo \"\u2713 INSERT INTO : \" . ($m[1] ?? 'unknown') . \"\\n\";"
                },
                {
                    "var": "err",
                    "line": 68,
                    "context": "foreach (array_unique($errors) as $err) {"
                },
                {
                    "var": "err",
                    "line": 69,
                    "context": "echo \"  - $err\\n\";"
                }
            ],
            "requires": [],
            "defined": [
                "sql_file",
                "sql_content",
                "success_count",
                "error_count",
                "errors",
                "statements",
                "stmt",
                "query",
                "e",
                "error_msg",
                "result",
                "table_count",
                "tables",
                "table"
            ],
            "used": 39
        },
        "migrate_database.php": {
            "problems": [
                {
                    "var": "matches",
                    "line": 37,
                    "context": "preg_match_all('/CREATE TABLE\\s+`([^`]+)`\\s*\\((.*?)\\)\\s*ENGINE/si', $sqlContent, $matches, PREG_SET_ORDER);"
                },
                {
                    "var": "matches",
                    "line": 39,
                    "context": "echo \"\ud83d\udcca \" . count($matches) . \" tables trouv\u00e9es dans le fichier SQL\\n\\n\";"
                },
                {
                    "var": "procMatches",
                    "line": 85,
                    "context": "preg_match_all('/CREATE\\s+DEFINER.*?PROCEDURE\\s+`([^`]+)`.*?BEGIN(.*?)END\\$\\$/si', file_get_contents($sqlFile), $procMatches, PREG_SET_ORDER);"
                }
            ],
            "requires": [],
            "defined": {
                "0": "e",
                "1": "sqlFile",
                "2": "sqlContent",
                "3": "createdTables",
                "4": "existingTables",
                "5": "errors",
                "6": "match",
                "7": "tableName",
                "8": "tableDefinition",
                "9": "stmt",
                "10": "exists",
                "11": "createSQL",
                "13": "errorMsg",
                "14": "error",
                "15": "procMatch",
                "16": "procName",
                "17": "procSQL"
            },
            "used": 37
        },
        "migrate_stock.php": {
            "problems": [
                {
                    "var": "run",
                    "line": 50,
                    "context": "if (!$run) {"
                }
            ],
            "requires": [],
            "defined": {
                "0": "hasMouvementsStock",
                "1": "hasStocksMouvements",
                "2": "stmt",
                "3": "rows",
                "4": "count",
                "5": "i",
                "6": "r",
                "7": "insert",
                "8": "migrated",
                "10": "produit_id",
                "11": "date_mouvement",
                "12": "type",
                "13": "quantite",
                "14": "source_type",
                "15": "source_id",
                "16": "commentaire",
                "17": "utilisateur_id",
                "18": "updateStmt",
                "19": "rowsUpdated",
                "20": "backupName",
                "21": "e"
            },
            "used": 41
        },
        "partials\\footer.php": {
            "problems": [
                {
                    "var": "appBaseUrl",
                    "line": 9,
                    "context": "<script src=\"<?= ($appBaseUrl !== '' ? $appBaseUrl : '') ?>/assets/js/modern-lists.js\"></script>"
                },
                {
                    "var": "appBaseUrl",
                    "line": 9,
                    "context": "<script src=\"<?= ($appBaseUrl !== '' ? $appBaseUrl : '') ?>/assets/js/modern-lists.js\"></script>"
                },
                {
                    "var": "appBaseUrl",
                    "line": 12,
                    "context": "<script src=\"<?= ($appBaseUrl !== '' ? $appBaseUrl : '') ?>/assets/js/modern-forms.js\"></script>"
                },
                {
                    "var": "appBaseUrl",
                    "line": 12,
                    "context": "<script src=\"<?= ($appBaseUrl !== '' ? $appBaseUrl : '') ?>/assets/js/modern-forms.js\"></script>"
                },
                {
                    "var": "appBaseUrl",
                    "line": 15,
                    "context": "<script src=\"<?= ($appBaseUrl !== '' ? $appBaseUrl : '') ?>/assets/js/tunnel-conversion.js\"></script>"
                },
                {
                    "var": "appBaseUrl",
                    "line": 15,
                    "context": "<script src=\"<?= ($appBaseUrl !== '' ? $appBaseUrl : '') ?>/assets/js/tunnel-conversion.js\"></script>"
                },
                {
                    "var": "appBaseUrl",
                    "line": 18,
                    "context": "<script src=\"<?= ($appBaseUrl !== '' ? $appBaseUrl : '') ?>/assets/js/dropdown-fix.js\"></script>"
                },
                {
                    "var": "appBaseUrl",
                    "line": 18,
                    "context": "<script src=\"<?= ($appBaseUrl !== '' ? $appBaseUrl : '') ?>/assets/js/dropdown-fix.js\"></script>"
                }
            ],
            "requires": [],
            "defined": [],
            "used": 8
        },
        "produits\\edit.php": {
            "problems": [
                {
                    "var": "id",
                    "line": 33,
                    "context": "$modeEdition = $id > 0;"
                },
                {
                    "var": "id",
                    "line": 54,
                    "context": "$stmt->execute([':id' => $id]);"
                },
                {
                    "var": "id",
                    "line": 70,
                    "context": "$stock_theorique = stock_get_quantite_produit($pdo, $id);"
                },
                {
                    "var": "id",
                    "line": 153,
                    "context": "':id' => $id,"
                },
                {
                    "var": "ajustement_stock",
                    "line": 157,
                    "context": "if ($ajustement_stock != 0) {"
                },
                {
                    "var": "ajustement_stock",
                    "line": 158,
                    "context": "$typeMvt = $ajustement_stock > 0 ? 'ENTREE' : 'SORTIE';"
                },
                {
                    "var": "id",
                    "line": 160,
                    "context": "'produit_id' => $id,"
                },
                {
                    "var": "ajustement_stock",
                    "line": 163,
                    "context": "'quantite' => abs($ajustement_stock),"
                },
                {
                    "var": "id",
                    "line": 270,
                    "context": "<input type=\"hidden\" name=\"id\" value=\"<?= (int)$id ?>\">"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "produitsListUrl",
                "erreurs",
                "stmt",
                "familles",
                "fournisseurs",
                "sc",
                "scParFamille",
                "r",
                "modeEdition",
                "code_produit",
                "designation",
                "caracteristiques",
                "description",
                "famille_id",
                "sous_categorie_id",
                "fournisseur_id",
                "localisation",
                "prix_achat",
                "prix_vente",
                "seuil_alerte",
                "actif",
                "image_path",
                "stock_theorique",
                "stock_initial",
                "prod",
                "uploadPath",
                "file",
                "ext",
                "filename",
                "uploadDir",
                "dest",
                "utilisateur",
                "userId",
                "sql",
                "typeMvt",
                "newId",
                "e",
                "csrfToken",
                "err",
                "fam",
                "f",
                "displayPath"
            ],
            "used": 123
        },
        "produits\\list.php": {
            "problems": [
                {
                    "var": "row",
                    "line": 73,
                    "context": "foreach ($stmtStock->fetchAll() as $row) {"
                },
                {
                    "var": "row",
                    "line": 74,
                    "context": "$stocks[(int)$row['produit_id']] = (float)$row['stock_qte'];"
                },
                {
                    "var": "row",
                    "line": 74,
                    "context": "$stocks[(int)$row['produit_id']] = (float)$row['stock_qte'];"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "q",
                "2": "actif",
                "3": "where",
                "4": "params",
                "5": "whereSql",
                "6": "sql",
                "7": "stmt",
                "8": "produits",
                "9": "stocks",
                "10": "stmtStock",
                "11": "e",
                "12": "p",
                "14": "id",
                "15": "stockActuel"
            },
            "used": 31
        },
        "promotions\\edit.php": {
            "problems": [
                {
                    "var": "id",
                    "line": 10,
                    "context": "$isEdit = $id > 0;"
                },
                {
                    "var": "id",
                    "line": 37,
                    "context": "$stmt->execute(['id' => $id]);"
                },
                {
                    "var": "id",
                    "line": 58,
                    "context": "$stmt->execute(['pid' => $id]);"
                },
                {
                    "var": "id",
                    "line": 136,
                    "context": "'id'                 => $id,"
                },
                {
                    "var": "id",
                    "line": 141,
                    "context": "$stmt->execute(['pid' => $id]);"
                },
                {
                    "var": "id",
                    "line": 149,
                    "context": "'pid'  => $id,"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "isEdit",
                "2": "stmt",
                "3": "produits",
                "4": "data",
                "5": "produitsSelectionnes",
                "6": "row",
                "7": "errors",
                "8": "pourcentage",
                "9": "montant",
                "10": "pourcentageVal",
                "11": "montantVal",
                "12": "pourcentageSql",
                "13": "montantSql",
                "14": "stmtInsert",
                "15": "pidProduit",
                "16": "newId",
                "18": "e",
                "19": "err",
                "20": "pr",
                "21": "idProd",
                "22": "selected"
            },
            "used": 97
        },
        "rapport_audit_bugs.php": {
            "problems": [
                {
                    "var": "this",
                    "line": 19,
                    "context": "'this', // $this dans m\u00e9thodes"
                },
                {
                    "var": "this",
                    "line": 36,
                    "context": "$this->check_ventes_list();"
                },
                {
                    "var": "this",
                    "line": 39,
                    "context": "$this->check_all_list_files();"
                },
                {
                    "var": "this",
                    "line": 42,
                    "context": "$this->check_filter_variables();"
                },
                {
                    "var": "date",
                    "line": 70,
                    "context": "if (preg_match('/\\$date(Deb|Fin)\\s*=/', $lines[$j])) {"
                },
                {
                    "var": "this",
                    "line": 81,
                    "context": "$this->vraix_bugs[] = ["
                },
                {
                    "var": "date_XX",
                    "line": 120,
                    "context": "// Chercher pattern: $date_XX utilis\u00e9e sans \u00eatre d\u00e9finie"
                },
                {
                    "var": "date",
                    "line": 125,
                    "context": "if (preg_match('/\\$date(Deb|Fin|Start|End|From|To)(?!\\s*=)/', $line)) {"
                },
                {
                    "var": "date",
                    "line": 129,
                    "context": "if (preg_match('/\\$date(?:Deb|Fin|Start|End|From|To)\\s*=/', $lines[$j])) {"
                },
                {
                    "var": "variable",
                    "line": 182,
                    "context": "// Pattern: htmlspecialchars(\\$variable) utilis\u00e9e en HTML"
                },
                {
                    "var": "m",
                    "line": 183,
                    "context": "if (preg_match('/htmlspecialchars\\(\\s*\\$(\\w+)\\s*\\)/', $line, $m)) {"
                },
                {
                    "var": "m",
                    "line": 184,
                    "context": "$var = $m[1];"
                },
                {
                    "var": "this",
                    "line": 197,
                    "context": "if (!$is_initialized && !in_array($var, $this->whitelist)) {"
                },
                {
                    "var": "issue",
                    "line": 212,
                    "context": "foreach (array_slice($filter_issues, 0, 20) as $issue) {"
                },
                {
                    "var": "issue",
                    "line": 213,
                    "context": "echo \"  \ud83d\udcc4 {$issue['file']}:{$issue['line']}\\n\";"
                },
                {
                    "var": "issue",
                    "line": 213,
                    "context": "echo \"  \ud83d\udcc4 {$issue['file']}:{$issue['line']}\\n\";"
                },
                {
                    "var": "issue",
                    "line": 214,
                    "context": "echo \"     Variable: \\${$issue['var']}\\n\";"
                },
                {
                    "var": "issue",
                    "line": 215,
                    "context": "echo \"     Code: \" . substr($issue['code'], 0, 60) . \"\\n\";"
                }
            ],
            "requires": [],
            "defined": {
                "0": "vraix_bugs",
                "1": "fichiers_analyses",
                "2": "whitelist",
                "3": "file",
                "4": "content",
                "5": "lines",
                "6": "i",
                "7": "line",
                "8": "line_num",
                "9": "is_initialized",
                "10": "j",
                "11": "dateDeb",
                "12": "dateFin",
                "13": "iterator",
                "14": "list_files",
                "16": "pattern_bugs",
                "20": "relative_file",
                "21": "bug",
                "22": "php_files",
                "24": "filter_issues",
                "28": "var",
                "29": "rapport",
                "30": "rapporteur"
            },
            "used": 95
        },
        "reset_db.php": {
            "problems": [
                {
                    "var": "DELIMITER",
                    "line": 68,
                    "context": "$procedure = $subparts[0] . 'END$$DELIMITER ;';"
                }
            ],
            "requires": [],
            "defined": [
                "DB_HOST",
                "DB_NAME",
                "DB_USER",
                "DB_PASS",
                "mysqli",
                "sql_file",
                "sql",
                "lines",
                "cleaned",
                "line",
                "parts",
                "count",
                "idx",
                "part",
                "subparts",
                "procedure",
                "rest",
                "rs",
                "queries",
                "q",
                "result",
                "row",
                "e"
            ],
            "used": 43
        },
        "scanner_variables.php": {
            "problems": [
                {
                    "var": "this",
                    "line": 17,
                    "context": "$this->load_php_files();"
                },
                {
                    "var": "this",
                    "line": 18,
                    "context": "echo \"\ud83d\udcca Fichiers trouv\u00e9s: \" . count($this->fichiers_php) . \"\\n\\n\";"
                },
                {
                    "var": "this",
                    "line": 22,
                    "context": "$this->analyser_fichier($file);"
                },
                {
                    "var": "this",
                    "line": 26,
                    "context": "$this->afficher_resultats();"
                },
                {
                    "var": "this",
                    "line": 40,
                    "context": "$this->fichiers_php[] = $path;"
                },
                {
                    "var": "this",
                    "line": 45,
                    "context": "sort($this->fichiers_php);"
                },
                {
                    "var": "all_vars",
                    "line": 53,
                    "context": "preg_match_all('/\\$([a-zA-Z_]\\w*)/', $content, $all_vars);"
                },
                {
                    "var": "all_vars",
                    "line": 54,
                    "context": "$vars_used = array_unique($all_vars[1]);"
                },
                {
                    "var": "this",
                    "line": 57,
                    "context": "$vars_defined = $this->get_defined_vars($content, $vars_used);"
                },
                {
                    "var": "this",
                    "line": 70,
                    "context": "$this->resultats[] = ["
                },
                {
                    "var": "this",
                    "line": 142,
                    "context": "echo \"Total: \" . count($this->resultats) . \" variables undefined\\n\";"
                }
            ],
            "requires": [],
            "defined": {
                "0": "resultats",
                "1": "fichiers_php",
                "2": "file",
                "3": "iterator",
                "5": "path",
                "6": "filepath",
                "7": "content",
                "8": "lines",
                "9": "vars_used",
                "10": "vars_defined",
                "11": "var",
                "12": "line_num",
                "13": "line",
                "15": "vars",
                "16": "defined",
                "18": "by_file",
                "19": "bug",
                "21": "bugs",
                "23": "scanner"
            },
            "used": 57
        },
        "scanner_variables_undefined.php": {
            "problems": [
                {
                    "var": "matches",
                    "line": 73,
                    "context": "if (preg_match_all('/\\$([a-zA-Z_][a-zA-Z0-9_]*)\\s*=/', $line, $matches)) {"
                },
                {
                    "var": "matches",
                    "line": 80,
                    "context": "if (preg_match_all('/\\$([a-zA-Z_][a-zA-Z0-9_]*)/', $line, $matches)) {"
                }
            ],
            "requires": [],
            "defined": {
                "0": "root_dir",
                "1": "exclude_dirs",
                "2": "problems_found",
                "3": "files_scanned",
                "4": "superglobals",
                "5": "dir",
                "7": "files",
                "8": "items",
                "9": "item",
                "10": "path",
                "11": "basename",
                "12": "file",
                "13": "problems",
                "15": "content",
                "16": "lines",
                "17": "defined_vars",
                "18": "used_vars",
                "19": "line_num",
                "20": "line",
                "21": "var",
                "22": "full_var",
                "23": "var_name",
                "24": "php_files",
                "25": "total_files",
                "26": "progress",
                "28": "new_progress",
                "29": "filtered_problems",
                "30": "problem",
                "31": "context",
                "32": "grouped",
                "37": "report_file"
            },
            "used": 91
        },
        "scanner_variables_v2.php": {
            "problems": [
                {
                    "var": "matches",
                    "line": 62,
                    "context": "if (preg_match_all('/(?:require|include)(?:_once)?\\s*[\\'\"]([^\\'\"]+)[\\'\"]/', $content, $matches)) {"
                },
                {
                    "var": "matches",
                    "line": 63,
                    "context": "$requires = $matches[1];"
                },
                {
                    "var": "m",
                    "line": 83,
                    "context": "if (preg_match('/catch\\s*\\(\\s*\\w+\\s+\\$(\\w+)\\s*\\)/', $line, $m)) {"
                },
                {
                    "var": "m",
                    "line": 84,
                    "context": "$defined[] = $m[1];"
                },
                {
                    "var": "m",
                    "line": 89,
                    "context": "if (preg_match('/foreach\\s*\\([^)]+\\s+as\\s+\\$(\\w+)(?:\\s*=>\\s*\\$(\\w+))?\\s*\\)/', $line, $m)) {"
                },
                {
                    "var": "m",
                    "line": 109,
                    "context": "if (preg_match('/function\\s+\\w+\\s*\\(([^)]*)\\)/', $line, $m)) {"
                },
                {
                    "var": "m",
                    "line": 110,
                    "context": "if (preg_match_all('/\\$(\\w+)/', $m[1], $params)) {"
                },
                {
                    "var": "params",
                    "line": 110,
                    "context": "if (preg_match_all('/\\$(\\w+)/', $m[1], $params)) {"
                },
                {
                    "var": "m",
                    "line": 119,
                    "context": "if (preg_match('/global\\s+\\$(\\w+)/', $line, $m)) {"
                },
                {
                    "var": "m",
                    "line": 120,
                    "context": "$defined[] = $m[1];"
                },
                {
                    "var": "matches",
                    "line": 127,
                    "context": "if (preg_match_all('/\\$(\\w+)\\s*=/', $line, $matches)) {"
                },
                {
                    "var": "m",
                    "line": 136,
                    "context": "if (preg_match('/list\\s*\\(([^)]+)\\)/', $line, $m)) {"
                },
                {
                    "var": "m",
                    "line": 137,
                    "context": "if (preg_match_all('/\\$(\\w+)/', $m[1], $listVars)) {"
                },
                {
                    "var": "listVars",
                    "line": 137,
                    "context": "if (preg_match_all('/\\$(\\w+)/', $m[1], $listVars)) {"
                },
                {
                    "var": "matches",
                    "line": 147,
                    "context": "if (preg_match_all('/\\$(\\w+)/', $line, $matches)) {"
                },
                {
                    "var": "problem",
                    "line": 251,
                    "context": "foreach (array_slice($data['problems'], 0, 5) as $problem) {"
                },
                {
                    "var": "problem",
                    "line": 252,
                    "context": "echo \"   Ligne {$problem['line']}: \\${$problem['var']}\\n\";"
                },
                {
                    "var": "problem",
                    "line": 252,
                    "context": "echo \"   Ligne {$problem['line']}: \\${$problem['var']}\\n\";"
                },
                {
                    "var": "problem",
                    "line": 253,
                    "context": "$context = substr($problem['context'], 0, 60);"
                },
                {
                    "var": "problem",
                    "line": 255,
                    "context": "if (strlen($problem['context']) > 60) echo \"...\";"
                }
            ],
            "requires": [],
            "defined": {
                "0": "excludedDirs",
                "1": "globalVars",
                "2": "dir",
                "4": "files",
                "5": "items",
                "6": "item",
                "7": "path",
                "8": "filePath",
                "10": "content",
                "11": "lines",
                "12": "defined",
                "13": "used",
                "14": "requires",
                "15": "req",
                "16": "lineNum",
                "17": "line",
                "18": "lineNumber",
                "19": "e",
                "20": "key",
                "21": "value",
                "22": "param1",
                "23": "param2",
                "24": "param",
                "25": "pdo",
                "26": "var",
                "28": "a",
                "29": "b",
                "32": "problems",
                "33": "usage",
                "34": "allProblems",
                "35": "totalProblems",
                "36": "filesWithProblems",
                "37": "progressStep",
                "38": "idx",
                "39": "file",
                "40": "percent",
                "41": "result",
                "42": "relativePath",
                "43": "count",
                "45": "data",
                "46": "context",
                "47": "jsonData"
            },
            "used": 120
        },
        "scripts\\fix_encoding_direct.php": {
            "problems": [
                {
                    "var": "row",
                    "line": 54,
                    "context": "foreach ($stmt->fetchAll(PDO::FETCH_ASSOC) as $row) {"
                },
                {
                    "var": "row",
                    "line": 55,
                    "context": "echo \"  \u2022 {$row['slug']}: {$row['designation']}\\n\";"
                },
                {
                    "var": "row",
                    "line": 55,
                    "context": "echo \"  \u2022 {$row['slug']}: {$row['designation']}\\n\";"
                }
            ],
            "requires": [],
            "defined": [
                "corrections",
                "count",
                "item",
                "stmt"
            ],
            "used": 16
        },
        "setup_compta.php": {
            "problems": [
                {
                    "var": "m",
                    "line": 150,
                    "context": "preg_match('/CREATE TABLE.*?(\\w+)\\s*\\(/', $query, $m);"
                },
                {
                    "var": "m",
                    "line": 151,
                    "context": "$type = ' [' . ($m[1] ?? 'table') . ']';"
                },
                {
                    "var": "m",
                    "line": 153,
                    "context": "preg_match('/ALTER TABLE\\s+(\\w+)/', $query, $m);"
                },
                {
                    "var": "m",
                    "line": 154,
                    "context": "$type = ' [' . ($m[1] ?? 'alter') . ']';"
                },
                {
                    "var": "m",
                    "line": 156,
                    "context": "preg_match('/INSERT INTO\\s+(\\w+)/', $query, $m);"
                },
                {
                    "var": "m",
                    "line": 157,
                    "context": "$type = ' [' . ($m[1] ?? 'insert') . ']';"
                }
            ],
            "requires": [],
            "defined": [
                "queries",
                "success",
                "error",
                "i",
                "query",
                "type",
                "e",
                "stmt",
                "result",
                "table_count",
                "tables",
                "table"
            ],
            "used": 27
        },
        "show_table.php": {
            "problems": [
                {
                    "var": "row",
                    "line": 8,
                    "context": "foreach ($stmt->fetchAll(PDO::FETCH_ASSOC) as $row) {"
                },
                {
                    "var": "row",
                    "line": 9,
                    "context": "echo $row['Field'] . \" | \" . $row['Type'] . \" | \" . $row['Null'] . \" | \" . ($row['Default'] ?? 'NULL') . \"\\n\";"
                },
                {
                    "var": "row",
                    "line": 9,
                    "context": "echo $row['Field'] . \" | \" . $row['Type'] . \" | \" . $row['Null'] . \" | \" . ($row['Default'] ?? 'NULL') . \"\\n\";"
                },
                {
                    "var": "row",
                    "line": 9,
                    "context": "echo $row['Field'] . \" | \" . $row['Type'] . \" | \" . $row['Null'] . \" | \" . ($row['Default'] ?? 'NULL') . \"\\n\";"
                },
                {
                    "var": "row",
                    "line": 9,
                    "context": "echo $row['Field'] . \" | \" . $row['Type'] . \" | \" . $row['Null'] . \" | \" . ($row['Default'] ?? 'NULL') . \"\\n\";"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "table",
                "stmt"
            ],
            "used": 9
        },
        "stock\\etat.php": {
            "problems": [
                {
                    "var": "hideZero",
                    "line": 56,
                    "context": "if ($hideZero && abs($stock) < 0.00001) {"
                },
                {
                    "var": "hideZero",
                    "line": 102,
                    "context": "<?= $hideZero ? 'checked' : '' ?>>"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "q",
                "where",
                "params",
                "sql",
                "stmt",
                "rows",
                "totalValeur",
                "totalArticles",
                "produitsAffiches",
                "r",
                "stock",
                "prixVente",
                "valeur",
                "p"
            ],
            "used": 37
        },
        "stock\\mouvements.php": {
            "problems": [
                {
                    "var": "produitId",
                    "line": 86,
                    "context": "$produitId,"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "typesMouvement",
                "2": "modulesSource",
                "3": "stmt",
                "4": "produits",
                "5": "produitsMap",
                "6": "p",
                "7": "dateMouvement",
                "8": "typeMouvement",
                "9": "quantiteRaw",
                "10": "quantite",
                "11": "sourceModule",
                "12": "sourceIdRaw",
                "13": "sourceId",
                "14": "commentaire",
                "15": "errors",
                "16": "e",
                "17": "dateDebut",
                "18": "dateFin",
                "19": "typeFiltre",
                "20": "where",
                "21": "params",
                "22": "whereSql",
                "23": "sql",
                "24": "mouvements",
                "25": "flashSuccess",
                "26": "flashError",
                "27": "csrfToken",
                "28": "t",
                "30": "m",
                "33": "produitFiltre",
                "35": "sens",
                "36": "q",
                "37": "affichageQte"
            },
            "used": 92
        },
        "test_exhaustif.php": {
            "problems": [
                {
                    "var": "this",
                    "line": 31,
                    "context": "$php_files = $this->get_php_files();"
                },
                {
                    "var": "variable",
                    "line": 37,
                    "context": "// Pattern: $variable utilis\u00e9e sans \u00eatre d\u00e9finie"
                },
                {
                    "var": "matches",
                    "line": 38,
                    "context": "if (preg_match_all('/\\$([a-zA-Z_]\\w*)/m', $content, $matches)) {"
                },
                {
                    "var": "matches",
                    "line": 39,
                    "context": "$vars_used = array_unique($matches[1]);"
                },
                {
                    "var": "_",
                    "line": 51,
                    "context": "\"/\\\\\\$_/\", // superglobale"
                },
                {
                    "var": "this",
                    "line": 64,
                    "context": "$line_num = $this->find_line_number($content, \"\\$$var\");"
                },
                {
                    "var": "this",
                    "line": 81,
                    "context": "$this->bugs[] = $msg;"
                },
                {
                    "var": "this",
                    "line": 96,
                    "context": "$php_files = $this->get_php_files();"
                },
                {
                    "var": "this",
                    "line": 118,
                    "context": "$this->bugs[] = $msg;"
                },
                {
                    "var": "dateDeb",
                    "line": 127,
                    "context": "* SCAN 3: Utilisations de $dateDeb, $dateFin sans initialisation"
                },
                {
                    "var": "dateFin",
                    "line": 127,
                    "context": "* SCAN 3: Utilisations de $dateDeb, $dateFin sans initialisation"
                },
                {
                    "var": "dateDeb",
                    "line": 130,
                    "context": "echo \"\ud83d\udd0d SCAN 3: Variables de Date ($dateDeb, $dateFin)\\n\";"
                },
                {
                    "var": "dateFin",
                    "line": 130,
                    "context": "echo \"\ud83d\udd0d SCAN 3: Variables de Date ($dateDeb, $dateFin)\\n\";"
                },
                {
                    "var": "this",
                    "line": 133,
                    "context": "$php_files = $this->get_php_files();"
                },
                {
                    "var": "dateDeb",
                    "line": 139,
                    "context": "// Rechercher utilisation de $dateDeb ou $dateFin"
                },
                {
                    "var": "dateFin",
                    "line": 139,
                    "context": "// Rechercher utilisation de $dateDeb ou $dateFin"
                },
                {
                    "var": "date",
                    "line": 140,
                    "context": "if (preg_match_all('/\\$date(Deb|Fin)/m', $content, $matches, PREG_OFFSET_CAPTURE)) {"
                },
                {
                    "var": "matches",
                    "line": 140,
                    "context": "if (preg_match_all('/\\$date(Deb|Fin)/m', $content, $matches, PREG_OFFSET_CAPTURE)) {"
                },
                {
                    "var": "date",
                    "line": 144,
                    "context": "if (!preg_match('/\\$date(Deb|Fin)\\s*=/', $content) &&"
                },
                {
                    "var": "date",
                    "line": 145,
                    "context": "preg_match('/\\$date(Deb|Fin)\\s*\\??\\?/', $content)) {"
                },
                {
                    "var": "this",
                    "line": 147,
                    "context": "$line = $this->find_line_number($content, '$date' . $matches[1][0]);"
                },
                {
                    "var": "date",
                    "line": 147,
                    "context": "$line = $this->find_line_number($content, '$date' . $matches[1][0]);"
                },
                {
                    "var": "matches",
                    "line": 147,
                    "context": "$line = $this->find_line_number($content, '$date' . $matches[1][0]);"
                },
                {
                    "var": "date",
                    "line": 150,
                    "context": "'var' => '$date' . $matches[1][0],"
                },
                {
                    "var": "matches",
                    "line": 150,
                    "context": "'var' => '$date' . $matches[1][0],"
                },
                {
                    "var": "this",
                    "line": 161,
                    "context": "$this->avertissements[] = $msg;"
                },
                {
                    "var": "dateDeb",
                    "line": 164,
                    "context": "echo \"\u2705 Variables \\$dateDeb et \\$dateFin correctement g\u00e9r\u00e9es\\n\";"
                },
                {
                    "var": "dateFin",
                    "line": 164,
                    "context": "echo \"\u2705 Variables \\$dateDeb et \\$dateFin correctement g\u00e9r\u00e9es\\n\";"
                },
                {
                    "var": "this",
                    "line": 190,
                    "context": "$php_files = $this->get_php_files();"
                },
                {
                    "var": "matches",
                    "line": 196,
                    "context": "if (preg_match_all(\"/['\\\"]([\\w_]+)['\\\"]\\s*(?:\\]|\\))/\", $content, $matches)) {"
                },
                {
                    "var": "table_match",
                    "line": 199,
                    "context": "if (preg_match(\"/FROM\\s+(\\w+)/i\", $content, $table_match)) {"
                },
                {
                    "var": "table_match",
                    "line": 200,
                    "context": "$table = $table_match[1];"
                },
                {
                    "var": "this",
                    "line": 203,
                    "context": "$line = $this->find_line_number($content, $col);"
                },
                {
                    "var": "this",
                    "line": 225,
                    "context": "$php_files = $this->get_php_files();"
                },
                {
                    "var": "matches",
                    "line": 232,
                    "context": "if (preg_match_all(\"/(?:require|include)(?:_once)?\\s+['\\\"]([^'\\\"]+)['\\\"]/\", $content, $matches)) {"
                },
                {
                    "var": "this",
                    "line": 267,
                    "context": "$this->bugs[] = $msg;"
                },
                {
                    "var": "this",
                    "line": 282,
                    "context": "$php_files = $this->get_php_files();"
                },
                {
                    "var": "_",
                    "line": 289,
                    "context": "if (preg_match_all('/\\$_(?:GET|POST|REQUEST)\\[[\\'\"]([^\\'\"]+)[\\'\"]\\](?!\\s*=\\s*(?:htmlspecialchars|htmlentities|mysqli_real_escape|addslashes))/', $content, $matches)) {"
                },
                {
                    "var": "matches",
                    "line": 289,
                    "context": "if (preg_match_all('/\\$_(?:GET|POST|REQUEST)\\[[\\'\"]([^\\'\"]+)[\\'\"]\\](?!\\s*=\\s*(?:htmlspecialchars|htmlentities|mysqli_real_escape|addslashes))/', $content, $matches)) {"
                },
                {
                    "var": "this",
                    "line": 291,
                    "context": "$line = $this->find_line_number($content, \"\\$_GET['$var']\");"
                },
                {
                    "var": "u",
                    "line": 302,
                    "context": "foreach (array_slice($unescaped, 0, 10) as $u) {"
                },
                {
                    "var": "u",
                    "line": 303,
                    "context": "$msg = \"\u26a0\ufe0f  Variable non \u00e9chapp\u00e9e: \\$_GET['{$u['var']}'] dans {$u['file']}:{$u['line']}\";"
                },
                {
                    "var": "u",
                    "line": 303,
                    "context": "$msg = \"\u26a0\ufe0f  Variable non \u00e9chapp\u00e9e: \\$_GET['{$u['var']}'] dans {$u['file']}:{$u['line']}\";"
                },
                {
                    "var": "u",
                    "line": 303,
                    "context": "$msg = \"\u26a0\ufe0f  Variable non \u00e9chapp\u00e9e: \\$_GET['{$u['var']}'] dans {$u['file']}:{$u['line']}\";"
                },
                {
                    "var": "this",
                    "line": 305,
                    "context": "$this->avertissements[] = $msg;"
                },
                {
                    "var": "this",
                    "line": 323,
                    "context": "$php_files = $this->get_php_files();"
                },
                {
                    "var": "matches",
                    "line": 330,
                    "context": "if (preg_match_all('/\\$pdo->query\\s*\\(\\s*[\"\\']([^\"\\']*\\$[^\"\\']*)[\"\\']/', $content, $matches)) {"
                },
                {
                    "var": "this",
                    "line": 332,
                    "context": "$line = $this->find_line_number($content, $sql);"
                },
                {
                    "var": "u",
                    "line": 343,
                    "context": "foreach (array_slice($unprepared, 0, 5) as $u) {"
                },
                {
                    "var": "u",
                    "line": 344,
                    "context": "$msg = \"\u26a0\ufe0f  Requ\u00eate SQL non pr\u00e9par\u00e9e dans {$u['file']}:{$u['line']}: {$u['sql']}...\";"
                },
                {
                    "var": "u",
                    "line": 344,
                    "context": "$msg = \"\u26a0\ufe0f  Requ\u00eate SQL non pr\u00e9par\u00e9e dans {$u['file']}:{$u['line']}: {$u['sql']}...\";"
                },
                {
                    "var": "u",
                    "line": 344,
                    "context": "$msg = \"\u26a0\ufe0f  Requ\u00eate SQL non pr\u00e9par\u00e9e dans {$u['file']}:{$u['line']}: {$u['sql']}...\";"
                },
                {
                    "var": "this",
                    "line": 346,
                    "context": "$this->avertissements[] = $msg;"
                },
                {
                    "var": "this",
                    "line": 376,
                    "context": "$this->fichiers_analyses = count($files);"
                },
                {
                    "var": "this",
                    "line": 395,
                    "context": "printf(\"\u2551 Fichiers analys\u00e9s: %d                                   \u2551\\n\", $this->fichiers_analyses);"
                },
                {
                    "var": "this",
                    "line": 396,
                    "context": "printf(\"\u2551 Bugs critiques trouv\u00e9s: %d                             \u2551\\n\", count($this->bugs));"
                },
                {
                    "var": "this",
                    "line": 397,
                    "context": "printf(\"\u2551 Avertissements: %d                                      \u2551\\n\", count($this->avertissements));"
                },
                {
                    "var": "this",
                    "line": 416,
                    "context": "$total_issues = count($this->bugs) + count($this->avertissements);"
                },
                {
                    "var": "this",
                    "line": 416,
                    "context": "$total_issues = count($this->bugs) + count($this->avertissements);"
                }
            ],
            "requires": [
                "db/db.php",
                " => $included,\r\n                                ",
                "]} dans {$m["
            ],
            "defined": {
                "0": "pdo",
                "1": "bugs",
                "2": "avertissements",
                "3": "fichiers_analyses",
                "4": "lignes_analysees",
                "5": "php_files",
                "6": "undefined_vars",
                "7": "file",
                "8": "content",
                "9": "vars_used",
                "10": "var",
                "11": "patterns",
                "12": "is_defined",
                "13": "pattern",
                "14": "line_num",
                "15": "bug",
                "16": "msg",
                "17": "syntax_errors",
                "19": "output",
                "20": "return",
                "21": "error_msg",
                "22": "error",
                "23": "date_bugs",
                "25": "line",
                "27": "column_bugs",
                "28": "existing_columns",
                "29": "tables",
                "30": "table",
                "31": "cols",
                "33": "col",
                "34": "missing",
                "36": "included",
                "37": "base_dir",
                "38": "full_path",
                "39": "m",
                "40": "unescaped",
                "43": "unprepared",
                "45": "sql",
                "46": "files",
                "47": "iterator",
                "49": "path",
                "51": "search",
                "52": "lines",
                "53": "i",
                "56": "warn",
                "57": "total_issues",
                "58": "testeur"
            },
            "used": 184
        },
        "test_expert_ui.php": {
            "problems": [
                {
                    "var": "this",
                    "line": 31,
                    "context": "$this->base_url = $base_url;"
                },
                {
                    "var": "this",
                    "line": 65,
                    "context": "$url = $this->base_url . $path;"
                },
                {
                    "var": "this",
                    "line": 81,
                    "context": "$url = $this->base_url . $path;"
                }
            ],
            "requires": [],
            "defined": {
                "0": "BASE_URL",
                "1": "TEST_USER",
                "2": "TEST_PASS",
                "3": "tests_total",
                "4": "tests_passes",
                "5": "tests_echoues",
                "6": "resultats",
                "7": "cookies",
                "8": "session_id",
                "9": "base_url",
                "10": "nom",
                "11": "callback",
                "13": "resultat",
                "14": "status",
                "15": "color",
                "16": "e",
                "17": "path",
                "18": "url",
                "19": "ch",
                "20": "response",
                "21": "http_code",
                "23": "data",
                "24": "test",
                "25": "result",
                "26": "start",
                "27": "time",
                "28": "pourcentage",
                "29": "r"
            },
            "used": 226
        },
        "test_final_corrections.php": {
            "problems": [
                {
                    "var": "c",
                    "line": 201,
                    "context": "$pass = array_reduce($tests, fn($c, $t) => $c + ($t[1] === 'PASS' ? 1 : 0), 0);"
                },
                {
                    "var": "t",
                    "line": 201,
                    "context": "$pass = array_reduce($tests, fn($c, $t) => $c + ($t[1] === 'PASS' ? 1 : 0), 0);"
                },
                {
                    "var": "c",
                    "line": 201,
                    "context": "$pass = array_reduce($tests, fn($c, $t) => $c + ($t[1] === 'PASS' ? 1 : 0), 0);"
                },
                {
                    "var": "t",
                    "line": 201,
                    "context": "$pass = array_reduce($tests, fn($c, $t) => $c + ($t[1] === 'PASS' ? 1 : 0), 0);"
                },
                {
                    "var": "c",
                    "line": 202,
                    "context": "$fail = array_reduce($tests, fn($c, $t) => $c + ($t[1] === 'FAIL' ? 1 : 0), 0);"
                },
                {
                    "var": "t",
                    "line": 202,
                    "context": "$fail = array_reduce($tests, fn($c, $t) => $c + ($t[1] === 'FAIL' ? 1 : 0), 0);"
                },
                {
                    "var": "c",
                    "line": 202,
                    "context": "$fail = array_reduce($tests, fn($c, $t) => $c + ($t[1] === 'FAIL' ? 1 : 0), 0);"
                },
                {
                    "var": "t",
                    "line": 202,
                    "context": "$fail = array_reduce($tests, fn($c, $t) => $c + ($t[1] === 'FAIL' ? 1 : 0), 0);"
                },
                {
                    "var": "c",
                    "line": 203,
                    "context": "$skip = array_reduce($tests, fn($c, $t) => $c + ($t[1] === 'SKIP' ? 1 : 0), 0);"
                },
                {
                    "var": "t",
                    "line": 203,
                    "context": "$skip = array_reduce($tests, fn($c, $t) => $c + ($t[1] === 'SKIP' ? 1 : 0), 0);"
                },
                {
                    "var": "c",
                    "line": 203,
                    "context": "$skip = array_reduce($tests, fn($c, $t) => $c + ($t[1] === 'SKIP' ? 1 : 0), 0);"
                },
                {
                    "var": "t",
                    "line": 203,
                    "context": "$skip = array_reduce($tests, fn($c, $t) => $c + ($t[1] === 'SKIP' ? 1 : 0), 0);"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "tests",
                "2": "fichiers_modifies",
                "3": "fichier",
                "4": "chemin",
                "5": "result",
                "6": "stmt",
                "7": "colonnes",
                "8": "colonnes_attendues",
                "9": "manquantes",
                "10": "colonnes_lignes",
                "11": "colonnes_lignes_attendues",
                "12": "manquantes_lignes",
                "13": "e",
                "14": "bl",
                "15": "ligne",
                "17": "fichiers_a_scanner",
                "18": "colonnes_dangereuses",
                "20": "contenu",
                "21": "problemes",
                "22": "pattern",
                "23": "note",
                "24": "pass",
                "25": "fail",
                "26": "skip"
            },
            "used": 78
        },
        "test_forms_catalogue.php": {
            "problems": [
                {
                    "var": "actif",
                    "line": 79,
                    "context": "echo \"  - Actif: \" . ($actif ? \"Oui\" : \"Non\") . \"\\n\";"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "_POST",
                "_FILES",
                "token",
                "e",
                "nom",
                "ordre",
                "errors",
                "slug",
                "stmt",
                "prod",
                "prodId",
                "product",
                "newDesignation",
                "result"
            ],
            "used": 24
        },
        "test_image_final.php": {
            "problems": [
                {
                    "var": "r",
                    "line": 20,
                    "context": "foreach ($stmt->fetchAll() as $r) {"
                },
                {
                    "var": "r",
                    "line": 21,
                    "context": "echo \"Produit: \" . $r['designation'] . \"\\n\";"
                },
                {
                    "var": "r",
                    "line": 22,
                    "context": "echo \"  Image (DB): \" . $r['image_principale'] . \"\\n\";"
                },
                {
                    "var": "r",
                    "line": 24,
                    "context": "$result = catalogue_image_path($r['image_principale']);"
                }
            ],
            "requires": [
                "security.php",
                "catalogue/controllers/catalogue_controller.php"
            ],
            "defined": {
                "0": "pdo",
                "1": "utilisateur",
                "3": "stmt",
                "4": "count_ok",
                "5": "count_fail",
                "6": "result"
            },
            "used": 11
        },
        "test_image_fixed.php": {
            "problems": [
                {
                    "var": "r",
                    "line": 44,
                    "context": "foreach ($stmt->fetchAll() as $r) {"
                },
                {
                    "var": "r",
                    "line": 45,
                    "context": "echo \"Produit: \" . $r['designation'] . \"\\n\";"
                },
                {
                    "var": "r",
                    "line": 46,
                    "context": "echo \"  Image (DB): \" . $r['image_principale'] . \"\\n\";"
                },
                {
                    "var": "r",
                    "line": 48,
                    "context": "$result = catalogue_image_path($r['image_principale']);"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "path",
                "fullPath",
                "uploadPath",
                "stmt",
                "result"
            ],
            "used": 18
        },
        "test_image_simple.php": {
            "problems": [
                {
                    "var": "r",
                    "line": 44,
                    "context": "foreach ($stmt->fetchAll() as $r) {"
                },
                {
                    "var": "r",
                    "line": 45,
                    "context": "echo \"Produit: \" . $r['designation'] . \"\\n\";"
                },
                {
                    "var": "r",
                    "line": 46,
                    "context": "echo \"  Image: \" . $r['image_principale'] . \"\\n\";"
                },
                {
                    "var": "r",
                    "line": 48,
                    "context": "$result = catalogue_image_path($r['image_principale']);"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "path",
                "fullPath",
                "uploadPath",
                "stmt",
                "result"
            ],
            "used": 18
        },
        "test_integration_catalogue.php": {
            "problems": [
                {
                    "var": "user_connected",
                    "line": 58,
                    "context": "<div class=\"test <?= $user_connected ? 'pass' : 'fail' ?>\">"
                },
                {
                    "var": "user_connected",
                    "line": 59,
                    "context": "<strong><?= $user_connected ? '\u2713' : '\u2717' ?> Utilisateur connect\u00e9</strong><br>"
                }
            ],
            "requires": [
                "security.php",
                "lib/pagination.php"
            ],
            "defined": {
                "0": "pdo",
                "1": "utilisateur",
                "3": "db_test",
                "4": "result",
                "5": "e",
                "6": "tables",
                "7": "table",
                "8": "stmt",
                "9": "cat_count",
                "10": "prod_count",
                "11": "functions",
                "12": "func"
            },
            "used": 15
        },
        "test_integration_import.php": {
            "problems": [
                {
                    "var": "r",
                    "line": 113,
                    "context": "$codes_in_file = array_map(fn($r) => trim($r['code']), $csv_data);"
                },
                {
                    "var": "r",
                    "line": 113,
                    "context": "$codes_in_file = array_map(fn($r) => trim($r['code']), $csv_data);"
                }
            ],
            "requires": [
                "security.php"
            ],
            "defined": {
                "0": "pdo",
                "1": "utilisateur",
                "3": "files",
                "4": "file",
                "5": "exists",
                "6": "readable",
                "7": "status",
                "8": "php_file",
                "9": "result",
                "10": "filepath",
                "11": "data",
                "12": "handle",
                "13": "headers",
                "14": "row_num",
                "15": "row",
                "16": "item",
                "17": "csv_data",
                "18": "errors",
                "19": "valid_count",
                "20": "idx",
                "22": "code",
                "23": "designation",
                "24": "categorie_id",
                "25": "prix_unite",
                "26": "codes_in_file",
                "27": "unique_codes",
                "28": "existing",
                "29": "new",
                "31": "stmt",
                "32": "categories",
                "33": "invalid_cats",
                "35": "cat_id",
                "36": "content",
                "37": "total_products",
                "38": "total_cats",
                "39": "summary",
                "40": "test"
            },
            "used": 67
        },
        "test_parcours_utilisateurs.php": {
            "problems": [
                {
                    "var": "this",
                    "line": 17,
                    "context": "$this->pdo = $pdo;"
                },
                {
                    "var": "this",
                    "line": 24,
                    "context": "$this->count_pass++;"
                },
                {
                    "var": "this",
                    "line": 27,
                    "context": "$this->count_fail++;"
                },
                {
                    "var": "this",
                    "line": 31,
                    "context": "$this->count_fail++;"
                },
                {
                    "var": "this",
                    "line": 44,
                    "context": "$total = $this->count_pass + $this->count_fail;"
                },
                {
                    "var": "this",
                    "line": 44,
                    "context": "$total = $this->count_pass + $this->count_fail;"
                },
                {
                    "var": "this",
                    "line": 45,
                    "context": "$percent = ($this->count_pass / $total) * 100;"
                },
                {
                    "var": "this",
                    "line": 52,
                    "context": "$total, $this->count_pass, $this->count_fail, $percent);"
                },
                {
                    "var": "this",
                    "line": 52,
                    "context": "$total, $this->count_pass, $this->count_fail, $percent);"
                }
            ],
            "requires": [
                "db/db.php"
            ],
            "defined": {
                "0": "pdo",
                "1": "resultats",
                "2": "count_pass",
                "3": "count_fail",
                "5": "nom",
                "6": "callback",
                "7": "result",
                "8": "status",
                "9": "e",
                "10": "titre",
                "11": "total",
                "12": "percent",
                "13": "test",
                "14": "stmt",
                "15": "row",
                "16": "cols",
                "17": "rows",
                "18": "senses",
                "19": "codes"
            },
            "used": 157
        },
        "test_phase1_2.php": {
            "problems": [
                {
                    "var": "c",
                    "line": 26,
                    "context": "$colsFound = array_filter($colsNeeded, fn($c) => in_array($c, $columns));"
                },
                {
                    "var": "c",
                    "line": 26,
                    "context": "$colsFound = array_filter($colsNeeded, fn($c) => in_array($c, $columns));"
                },
                {
                    "var": "c",
                    "line": 53,
                    "context": "$signatureCols = array_filter($cols, fn($c) => in_array($c['Field'], ['signature', 'signature_date', 'signature_client_nom']));"
                },
                {
                    "var": "c",
                    "line": 53,
                    "context": "$signatureCols = array_filter($cols, fn($c) => in_array($c['Field'], ['signature', 'signature_date', 'signature_client_nom']));"
                },
                {
                    "var": "b",
                    "line": 88,
                    "context": "$unsigned = array_filter($bls, fn($b) => !$b['signature']);"
                },
                {
                    "var": "b",
                    "line": 88,
                    "context": "$unsigned = array_filter($bls, fn($b) => !$b['signature']);"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "stmt",
                "2": "columns",
                "3": "colsNeeded",
                "4": "colsFound",
                "5": "col",
                "6": "e",
                "7": "cols",
                "8": "signatureCols",
                "11": "bls",
                "12": "bl",
                "13": "hasSig",
                "14": "unsigned",
                "15": "testBL",
                "17": "files",
                "18": "file",
                "19": "desc",
                "20": "fullPath",
                "21": "size",
                "22": "jsFile",
                "23": "jsContent",
                "24": "checks",
                "25": "pattern",
                "27": "apiFile",
                "28": "apiContent",
                "29": "apiChecks"
            },
            "used": 50
        },
        "test_phase1_2_fixed.php": {
            "problems": [
                {
                    "var": "c",
                    "line": 44,
                    "context": "$signe_col = array_filter($cols, fn($c) => $c['Field'] === 'signe_client')[0] ?? null;"
                },
                {
                    "var": "c",
                    "line": 44,
                    "context": "$signe_col = array_filter($cols, fn($c) => $c['Field'] === 'signe_client')[0] ?? null;"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "stmt",
                "2": "columns",
                "3": "e",
                "4": "cols",
                "5": "signe_col",
                "7": "bl",
                "9": "result"
            },
            "used": 23
        },
        "test_regression_modifications.php": {
            "problems": [
                {
                    "var": "c",
                    "line": 228,
                    "context": "$pass = array_reduce($tests, fn($c, $t) => $c + ($t[2] === 'PASS' ? 1 : 0), 0);"
                },
                {
                    "var": "t",
                    "line": 228,
                    "context": "$pass = array_reduce($tests, fn($c, $t) => $c + ($t[2] === 'PASS' ? 1 : 0), 0);"
                },
                {
                    "var": "c",
                    "line": 228,
                    "context": "$pass = array_reduce($tests, fn($c, $t) => $c + ($t[2] === 'PASS' ? 1 : 0), 0);"
                },
                {
                    "var": "t",
                    "line": 228,
                    "context": "$pass = array_reduce($tests, fn($c, $t) => $c + ($t[2] === 'PASS' ? 1 : 0), 0);"
                },
                {
                    "var": "c",
                    "line": 229,
                    "context": "$fail = array_reduce($tests, fn($c, $t) => $c + ($t[2] === 'FAIL' ? 1 : 0), 0);"
                },
                {
                    "var": "t",
                    "line": 229,
                    "context": "$fail = array_reduce($tests, fn($c, $t) => $c + ($t[2] === 'FAIL' ? 1 : 0), 0);"
                },
                {
                    "var": "c",
                    "line": 229,
                    "context": "$fail = array_reduce($tests, fn($c, $t) => $c + ($t[2] === 'FAIL' ? 1 : 0), 0);"
                },
                {
                    "var": "t",
                    "line": 229,
                    "context": "$fail = array_reduce($tests, fn($c, $t) => $c + ($t[2] === 'FAIL' ? 1 : 0), 0);"
                },
                {
                    "var": "c",
                    "line": 230,
                    "context": "$skip = array_reduce($tests, fn($c, $t) => $c + ($t[2] === 'SKIP' ? 1 : 0), 0);"
                },
                {
                    "var": "t",
                    "line": 230,
                    "context": "$skip = array_reduce($tests, fn($c, $t) => $c + ($t[2] === 'SKIP' ? 1 : 0), 0);"
                },
                {
                    "var": "c",
                    "line": 230,
                    "context": "$skip = array_reduce($tests, fn($c, $t) => $c + ($t[2] === 'SKIP' ? 1 : 0), 0);"
                },
                {
                    "var": "t",
                    "line": 230,
                    "context": "$skip = array_reduce($tests, fn($c, $t) => $c + ($t[2] === 'SKIP' ? 1 : 0), 0);"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "tests",
                "2": "failures",
                "3": "result",
                "4": "stmt",
                "5": "bl",
                "6": "colonnes_requises",
                "7": "manquantes",
                "8": "col",
                "9": "e",
                "10": "lignes",
                "11": "ligne",
                "14": "colonnes",
                "15": "row",
                "17": "etat_avant",
                "18": "vente",
                "19": "etat_apres",
                "21": "pass",
                "22": "fail",
                "23": "skip",
                "24": "i",
                "25": "f"
            },
            "used": 93
        },
        "test_relances_devis.php": {
            "problems": [
                {
                    "var": "d",
                    "line": 46,
                    "context": "foreach (array_slice($devis_list, 0, 5) as $d) {"
                },
                {
                    "var": "d",
                    "line": 47,
                    "context": "$jours = $d['jours_restants'] !== null ? $d['jours_restants'] . ' jours' : 'Ind\u00e9fini';"
                },
                {
                    "var": "d",
                    "line": 47,
                    "context": "$jours = $d['jours_restants'] !== null ? $d['jours_restants'] . ' jours' : 'Ind\u00e9fini';"
                },
                {
                    "var": "d",
                    "line": 48,
                    "context": "$relances = $d['nb_relances'] ?? 0;"
                },
                {
                    "var": "d",
                    "line": 49,
                    "context": "$montant = number_format($d['montant_total_ttc'], 0, ',', ' ');"
                },
                {
                    "var": "d",
                    "line": 53,
                    "context": "$d['numero'],"
                },
                {
                    "var": "d",
                    "line": 54,
                    "context": "$d['client_nom'],"
                },
                {
                    "var": "d",
                    "line": 71,
                    "context": "$devis_a_relancer_urgent = array_filter($devis_list, function($d) {"
                },
                {
                    "var": "d",
                    "line": 72,
                    "context": "return $d['jours_restants'] !== null && $d['jours_restants'] <= 3;"
                },
                {
                    "var": "d",
                    "line": 72,
                    "context": "return $d['jours_restants'] !== null && $d['jours_restants'] <= 3;"
                },
                {
                    "var": "d",
                    "line": 75,
                    "context": "$devis_sans_relance = array_filter($devis_list, function($d) {"
                },
                {
                    "var": "d",
                    "line": 76,
                    "context": "return $d['nb_relances'] == 0;"
                },
                {
                    "var": "d",
                    "line": 80,
                    "context": "$devis_relances_recentes = array_filter($devis_list, function($d) use ($today) {"
                },
                {
                    "var": "d",
                    "line": 81,
                    "context": "if (!$d['derniere_relance']) return false;"
                },
                {
                    "var": "d",
                    "line": 82,
                    "context": "$diff = (strtotime($today) - strtotime($d['derniere_relance'])) / 86400;"
                }
            ],
            "requires": [],
            "defined": [
                "stmtDevis",
                "devis_list",
                "jours",
                "relances",
                "montant",
                "devis_a_relancer_urgent",
                "devis_sans_relance",
                "today",
                "devis_relances_recentes",
                "diff",
                "stmt",
                "columns",
                "required_columns",
                "missing",
                "result",
                "e"
            ],
            "used": 44
        },
        "test_simulation_complet.php": {
            "problems": [
                {
                    "var": "errno",
                    "line": 35,
                    "context": "set_error_handler(function($errno, $errstr, $errfile, $errline) {"
                },
                {
                    "var": "errstr",
                    "line": 35,
                    "context": "set_error_handler(function($errno, $errstr, $errfile, $errline) {"
                },
                {
                    "var": "errfile",
                    "line": 35,
                    "context": "set_error_handler(function($errno, $errstr, $errfile, $errline) {"
                },
                {
                    "var": "errline",
                    "line": 35,
                    "context": "set_error_handler(function($errno, $errstr, $errfile, $errline) {"
                },
                {
                    "var": "errstr",
                    "line": 39,
                    "context": "'message' => $errstr,"
                },
                {
                    "var": "errfile",
                    "line": 40,
                    "context": "'file' => $errfile,"
                },
                {
                    "var": "errline",
                    "line": 41,
                    "context": "'line' => $errline"
                },
                {
                    "var": "t",
                    "line": 228,
                    "context": "$pass_count = count(array_filter($tests, fn($t) => $t['status'] === 'PASS'));"
                },
                {
                    "var": "t",
                    "line": 228,
                    "context": "$pass_count = count(array_filter($tests, fn($t) => $t['status'] === 'PASS'));"
                },
                {
                    "var": "t",
                    "line": 229,
                    "context": "$fail_count = count(array_filter($tests, fn($t) => $t['status'] === 'FAIL'));"
                },
                {
                    "var": "t",
                    "line": 229,
                    "context": "$fail_count = count(array_filter($tests, fn($t) => $t['status'] === 'FAIL'));"
                }
            ],
            "requires": [
                "security.php",
                "lib/pagination.php",
                "admin/catalogue/categories.php"
            ],
            "defined": {
                "0": "pdo",
                "1": "utilisateur",
                "2": "errors",
                "3": "tests",
                "7": "_GET",
                "8": "_POST",
                "9": "test1",
                "10": "html",
                "11": "e",
                "12": "files_to_check",
                "13": "file",
                "14": "filepath",
                "15": "output",
                "16": "critical_functions",
                "17": "func",
                "18": "token1",
                "19": "token2",
                "21": "stmt",
                "22": "cat_count",
                "23": "prod_count",
                "25": "pass_count",
                "26": "fail_count",
                "27": "total",
                "28": "test_name",
                "29": "result"
            },
            "used": 81
        },
        "utilisateurs\\edit.php": {
            "problems": [
                {
                    "var": "rolesSelectionnes",
                    "line": 194,
                    "context": "$rolesActuels = $rolesSelectionnes;"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "modeEdition",
                "stmt",
                "roles",
                "login",
                "nom_complet",
                "email",
                "telephone",
                "actif",
                "rolesActuels",
                "erreurs",
                "user",
                "csrf",
                "id",
                "motDePasse",
                "motDePasseConfirm",
                "sqlLogin",
                "paramsLogin",
                "sql",
                "hash",
                "stmtDel",
                "stmtIns",
                "rid",
                "csrfToken",
                "err",
                "role",
                "checked"
            ],
            "used": 84
        },
        "ventes\\detail.php": {
            "problems": [
                {
                    "var": "id",
                    "line": 17,
                    "context": "if ($id <= 0) {"
                },
                {
                    "var": "id",
                    "line": 37,
                    "context": "$stmt->execute(['id' => $id]);"
                },
                {
                    "var": "id",
                    "line": 54,
                    "context": "$stmt->execute(['id' => $id]);"
                },
                {
                    "var": "id",
                    "line": 64,
                    "context": "$stmt->execute(['id' => $id]);"
                },
                {
                    "var": "id",
                    "line": 75,
                    "context": "$stmt->execute(['id' => $id]);"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "ventesBasePath",
                "ventesListUrl",
                "ventesEditUrl",
                "ventesGenererBlUrl",
                "stmt",
                "vente",
                "lignes",
                "bonsLivraison",
                "ordresPreparation",
                "peutModifierVente",
                "peutCreerBL",
                "flashSuccess",
                "flashError",
                "badgeClass",
                "lg",
                "op",
                "bl"
            ],
            "used": 85
        },
        "ventes\\detail_360.php": {
            "problems": [
                {
                    "var": "l",
                    "line": 117,
                    "context": "$totalRetourne = array_sum(array_map(function($l) {"
                },
                {
                    "var": "l",
                    "line": 118,
                    "context": "return ($l['montant_rembourse'] ?? 0) + ($l['montant_avoir'] ?? 0);"
                },
                {
                    "var": "l",
                    "line": 118,
                    "context": "return ($l['montant_rembourse'] ?? 0) + ($l['montant_avoir'] ?? 0);"
                },
                {
                    "var": "carry",
                    "line": 125,
                    "context": "$tousLesBLGeneresEtSignes = (count($livraisons) > 0) && array_reduce($livraisons, function($carry, $bl) {"
                },
                {
                    "var": "bl",
                    "line": 125,
                    "context": "$tousLesBLGeneresEtSignes = (count($livraisons) > 0) && array_reduce($livraisons, function($carry, $bl) {"
                },
                {
                    "var": "carry",
                    "line": 126,
                    "context": "return $carry && ((int)($bl['signe_client'] ?? 0) === 1);"
                },
                {
                    "var": "bl",
                    "line": 126,
                    "context": "return $carry && ((int)($bl['signe_client'] ?? 0) === 1);"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "venteId",
                "stmt",
                "vente",
                "lignes",
                "ordres",
                "livraisons",
                "litiges",
                "mouvementsStock",
                "ecritures",
                "encaissements",
                "totalLivree",
                "tauxLivraison",
                "totalRetourne",
                "totalEncaisse",
                "tauxEncaissement",
                "tousLesBLGeneresEtSignes",
                "sync_ok",
                "ligne",
                "ordre",
                "livraison",
                "litige",
                "montant",
                "mvt",
                "enc",
                "stmt_mode",
                "mode",
                "ecr"
            ],
            "used": 124
        },
        "ventes\\edit.php": {
            "problems": [
                {
                    "var": "id",
                    "line": 15,
                    "context": "$isEdit = $id > 0;"
                },
                {
                    "var": "id",
                    "line": 31,
                    "context": "$stmt->execute([$id]);"
                },
                {
                    "var": "id",
                    "line": 53,
                    "context": "$stmt->execute(['id' => $id]);"
                },
                {
                    "var": "id",
                    "line": 87,
                    "context": "$stmt->execute(['id' => $id]);"
                },
                {
                    "var": "id",
                    "line": 191,
                    "context": "'id'             => $id,"
                },
                {
                    "var": "id",
                    "line": 196,
                    "context": "$stmt->execute(['id' => $id]);"
                },
                {
                    "var": "id",
                    "line": 207,
                    "context": "'vente_id'        => $id,"
                },
                {
                    "var": "id",
                    "line": 218,
                    "context": "stock_synchroniser_vente($pdo, $id);"
                },
                {
                    "var": "id",
                    "line": 311,
                    "context": "<a href=\"<?= url_for('coordination/ordres_preparation_edit.php?vente_id=' . $id) ?>\""
                },
                {
                    "var": "id",
                    "line": 316,
                    "context": "<a href=\"<?= url_for('livraisons/create.php?vente_id=' . $id) ?>\""
                },
                {
                    "var": "id",
                    "line": 321,
                    "context": "<a href=\"<?= url_for('coordination/dashboard.php?vente_id=' . $id) ?>\""
                },
                {
                    "var": "id",
                    "line": 337,
                    "context": "data-vente-id=\"<?= $id ?>\""
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "TAUX_TVA",
                "2": "isEdit",
                "3": "stmt",
                "4": "canaux",
                "5": "produitsById",
                "6": "produitsExistants",
                "7": "p",
                "8": "data",
                "9": "clientLabel",
                "10": "lignes",
                "11": "vente",
                "12": "stmtCli",
                "13": "cli",
                "14": "parts",
                "15": "errors",
                "16": "produitIds",
                "17": "qtes",
                "18": "prixUnit",
                "19": "remises",
                "20": "totalHT",
                "21": "idx",
                "22": "prodIdRaw",
                "23": "prodId",
                "24": "q",
                "25": "pu",
                "26": "rem",
                "27": "montantBrut",
                "28": "montantLigneHT",
                "29": "totalTTC",
                "30": "utilisateur",
                "31": "utilisateurId",
                "32": "stmtL",
                "33": "lg",
                "34": "numero",
                "35": "venteId",
                "37": "e",
                "39": "statut_encaissement",
                "40": "montant_total",
                "41": "err",
                "42": "cv",
                "43": "s",
                "44": "nbLignesAffichees",
                "45": "i",
                "46": "montantIndicatif"
            },
            "used": 151
        },
        "ventes\\export_excel.php": {
            "problems": [
                {
                    "var": "clientId",
                    "line": 27,
                    "context": "if ($clientId > 0) {"
                },
                {
                    "var": "clientId",
                    "line": 29,
                    "context": "$params[':client_id'] = $clientId;"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "dateDebut",
                "dateFin",
                "statut",
                "where",
                "params",
                "sql",
                "stmt",
                "ventes",
                "output",
                "v"
            ],
            "used": 28
        },
        "ventes\\generer_bl.php": {
            "problems": [
                {
                    "var": "venteId",
                    "line": 19,
                    "context": "if ($venteId <= 0) {"
                },
                {
                    "var": "venteId",
                    "line": 30,
                    "context": "$stmt->execute(['id' => $venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 47,
                    "context": "$stmt->execute(['id' => $venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 62,
                    "context": "$stmt->execute(['vente_id' => $venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 115,
                    "context": "'vente_id'      => $venteId,"
                },
                {
                    "var": "venteId",
                    "line": 151,
                    "context": "'source_id'      => $venteId,"
                },
                {
                    "var": "venteId",
                    "line": 168,
                    "context": "$stmt->execute(['vente_id' => $venteId]);"
                },
                {
                    "var": "venteId",
                    "line": 188,
                    "context": "'id'     => $venteId,"
                },
                {
                    "var": "venteId",
                    "line": 201,
                    "context": "header('Location: ' . url_for('ventes/detail.php') . '?id=' . $venteId);"
                }
            ],
            "requires": [],
            "defined": [
                "pdo",
                "stmt",
                "vente",
                "lignesVente",
                "livraisonsExistantes",
                "qteLivreeParProduit",
                "row",
                "lignesALivrer",
                "lv",
                "prodId",
                "qteCommandee",
                "qteLivree",
                "qteRestante",
                "stockDispo",
                "dateBL",
                "numeroBL",
                "utilisateur",
                "magasinierId",
                "blId",
                "stmtBL",
                "lg",
                "qte",
                "rows",
                "toutLivre",
                "r",
                "nouveauStatut",
                "e"
            ],
            "used": 61
        },
        "ventes\\list.php": {
            "problems": [
                {
                    "var": "pagination",
                    "line": 139,
                    "context": "$limitClause = getPaginationLimitClause($pagination['offset'], $pagination['per_page']);"
                },
                {
                    "var": "pagination",
                    "line": 139,
                    "context": "$limitClause = getPaginationLimitClause($pagination['offset'], $pagination['per_page']);"
                },
                {
                    "var": "pagination",
                    "line": 162,
                    "context": "<span class=\"count-badge ms-2\"><?= $pagination['total_count'] ?></span>"
                },
                {
                    "var": "pagination",
                    "line": 320,
                    "context": "<?php if ($pagination['total_count'] > 0): ?>"
                },
                {
                    "var": "pagination",
                    "line": 321,
                    "context": "<?= renderPaginationControls($pagination, $_GET) ?>"
                },
                {
                    "var": "pagination",
                    "line": 489,
                    "context": "<?= renderPaginationControls($pagination, $_GET) ?>"
                }
            ],
            "requires": [],
            "defined": {
                "0": "pdo",
                "1": "utilisateur",
                "2": "user_id",
                "3": "today",
                "4": "date_start",
                "5": "date_end",
                "6": "range",
                "7": "statut",
                "8": "encaissement",
                "9": "search",
                "10": "dateDeb",
                "11": "dateFin",
                "12": "prefs",
                "13": "sortBy",
                "14": "sortDir",
                "15": "per_page",
                "16": "stmt",
                "17": "clients",
                "18": "canaux",
                "19": "where",
                "20": "params",
                "21": "searchTerm",
                "22": "whereSql",
                "23": "orderSql",
                "24": "sql",
                "25": "countSql",
                "26": "stmtCount",
                "27": "totalCount",
                "28": "limitClause",
                "29": "ventes",
                "30": "peutCreerVente",
                "31": "flashSuccess",
                "32": "flashError",
                "33": "date_start_input",
                "34": "date_end_input",
                "35": "s",
                "36": "cl",
                "37": "clientId",
                "38": "cv",
                "39": "canalId",
                "40": "activeFilters",
                "41": "clientName",
                "42": "c",
                "43": "canalName",
                "45": "label",
                "46": "value",
                "47": "v",
                "48": "badgeClass",
                "49": "badgeIcon",
                "50": "encaissementBadge",
                "51": "encaissementIcon",
                "52": "encaissementText"
            },
            "used": 141
        }
    }
}